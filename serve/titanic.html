<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Titanic | Online Portfolio</title>
  <meta name="description" content="Chapter 2 Titanic | Online Portfolio" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Titanic | Online Portfolio" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Titanic | Online Portfolio" />
  
  
  

<meta name="author" content="Owen Michel" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>

<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="setup/setup.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="titanic.html"><a href="titanic.html"><i class="fa fa-check"></i><b>2</b> Titanic</a>
<ul>
<li class="chapter" data-level="2.1" data-path="titanic.html"><a href="titanic.html#imports"><i class="fa fa-check"></i><b>2.1</b> Imports</a></li>
<li class="chapter" data-level="2.2" data-path="titanic.html"><a href="titanic.html#data"><i class="fa fa-check"></i><b>2.2</b> Data</a></li>
<li class="chapter" data-level="2.3" data-path="titanic.html"><a href="titanic.html#eda"><i class="fa fa-check"></i><b>2.3</b> EDA</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="titanic.html"><a href="titanic.html#missing-data"><i class="fa fa-check"></i><b>2.3.1</b> Missing Data</a></li>
<li class="chapter" data-level="2.3.2" data-path="titanic.html"><a href="titanic.html#correlation"><i class="fa fa-check"></i><b>2.3.2</b> Correlation</a></li>
<li class="chapter" data-level="2.3.3" data-path="titanic.html"><a href="titanic.html#pivot-features"><i class="fa fa-check"></i><b>2.3.3</b> Pivot Features</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="titanic.html"><a href="titanic.html#visualization"><i class="fa fa-check"></i><b>2.4</b> Visualization</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="titanic.html"><a href="titanic.html#feature-engineering"><i class="fa fa-check"></i><b>2.4.1</b> Feature Engineering</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="titanic.html"><a href="titanic.html#models"><i class="fa fa-check"></i><b>2.5</b> Models</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="titanic.html"><a href="titanic.html#prepartion"><i class="fa fa-check"></i><b>2.5.1</b> Prepartion</a></li>
<li class="chapter" data-level="2.5.2" data-path="titanic.html"><a href="titanic.html#run-models"><i class="fa fa-check"></i><b>2.5.2</b> Run Models</a></li>
<li class="chapter" data-level="2.5.3" data-path="titanic.html"><a href="titanic.html#xgboost-model"><i class="fa fa-check"></i><b>2.5.3</b> Xgboost model</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Online Portfolio</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="titanic" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> Titanic</h1>
<div id="imports" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Imports</h2>
<p>Import the packages that will be used throughout the project.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="titanic.html#cb1-1" aria-hidden="true"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="titanic.html#cb1-2" aria-hidden="true"></a><span class="im">import</span> random <span class="im">as</span> rnd</span>
<span id="cb1-3"><a href="titanic.html#cb1-3" aria-hidden="true"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="titanic.html#cb1-4" aria-hidden="true"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="titanic.html#cb1-5" aria-hidden="true"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="titanic.html#cb1-6" aria-hidden="true"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-7"><a href="titanic.html#cb1-7" aria-hidden="true"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> (</span>
<span id="cb1-8"><a href="titanic.html#cb1-8" aria-hidden="true"></a>    classification_report,</span>
<span id="cb1-9"><a href="titanic.html#cb1-9" aria-hidden="true"></a>    confusion_matrix,</span>
<span id="cb1-10"><a href="titanic.html#cb1-10" aria-hidden="true"></a>    explained_variance_score,</span>
<span id="cb1-11"><a href="titanic.html#cb1-11" aria-hidden="true"></a>    mean_absolute_error,</span>
<span id="cb1-12"><a href="titanic.html#cb1-12" aria-hidden="true"></a>    mean_squared_error,</span>
<span id="cb1-13"><a href="titanic.html#cb1-13" aria-hidden="true"></a>)</span>
<span id="cb1-14"><a href="titanic.html#cb1-14" aria-hidden="true"></a><span class="im">from</span> xgboost <span class="im">import</span> XGBRegressor</span></code></pre></div>
<p>Import the data, and combine the data frames to be able to process all the data in one go
(opposed to working on the test and training datasets separately).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="titanic.html#cb2-1" aria-hidden="true"></a>df_train <span class="op">=</span> pd.read_csv(<span class="st">&quot;~/docs/codeing/python/titanic/train.csv&quot;</span>)</span>
<span id="cb2-2"><a href="titanic.html#cb2-2" aria-hidden="true"></a>df_test  <span class="op">=</span> pd.read_csv(<span class="st">&quot;~/docs/codeing/python/titanic/test.csv&quot;</span>)</span>
<span id="cb2-3"><a href="titanic.html#cb2-3" aria-hidden="true"></a>df <span class="op">=</span> pd.concat([df_train, df_test])</span></code></pre></div>
</div>
<div id="data" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Data</h2>
<p>Show a random sample of the data</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="titanic.html#cb3-1" aria-hidden="true"></a>df_sample <span class="op">=</span> df.sample(n<span class="op">=</span><span class="dv">10</span>)</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ipxjimyamn .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ipxjimyamn .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ipxjimyamn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ipxjimyamn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ipxjimyamn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ipxjimyamn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ipxjimyamn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 10;
  font-weight: bold;
  text-transform: capitalize;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ipxjimyamn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 10;
  font-weight: bold;
  text-transform: capitalize;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ipxjimyamn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ipxjimyamn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ipxjimyamn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ipxjimyamn .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ipxjimyamn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ipxjimyamn .gt_from_md > :first-child {
  margin-top: 0;
}

#ipxjimyamn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ipxjimyamn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ipxjimyamn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ipxjimyamn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ipxjimyamn .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ipxjimyamn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ipxjimyamn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ipxjimyamn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ipxjimyamn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ipxjimyamn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ipxjimyamn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ipxjimyamn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ipxjimyamn .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ipxjimyamn .gt_left {
  text-align: left;
}

#ipxjimyamn .gt_center {
  text-align: center;
}

#ipxjimyamn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ipxjimyamn .gt_font_normal {
  font-weight: normal;
}

#ipxjimyamn .gt_font_bold {
  font-weight: bold;
}

#ipxjimyamn .gt_font_italic {
  font-style: italic;
}

#ipxjimyamn .gt_super {
  font-size: 65%;
}

#ipxjimyamn .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="ipxjimyamn" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="12" class="gt_heading gt_title gt_font_normal" style><strong>Data Frame Head</strong></th>
    </tr>
    <tr>
      <th colspan="12" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style><em>A random selection of 10 rows of the Titanic data.</em></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">PassengerId</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Survived</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Pclass</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Sex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Age</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">SibSp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Parch</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Ticket</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Fare</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">Cabin</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Embarked</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_right">564</td>
      <td class="gt_row gt_right">0</td>
      <td class="gt_row gt_right">3</td>
      <td class="gt_row gt_left">Simmons, Mr. John</td>
      <td class="gt_row gt_left">male</td>
      <td class="gt_row gt_right">NaN</td>
      <td class="gt_row gt_right">0</td>
      <td class="gt_row gt_right">0</td>
      <td class="gt_row gt_left">SOTON/OQ 392082</td>
      <td class="gt_row gt_right">8.0500</td>
      <td class="gt_row gt_center">NaN</td>
      <td class="gt_row gt_left">S</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">79</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">2</td>
      <td class="gt_row gt_left">Caldwell, Master. Alden Gates</td>
      <td class="gt_row gt_left">male</td>
      <td class="gt_row gt_right">0.83</td>
      <td class="gt_row gt_right">0</td>
      <td class="gt_row gt_right">2</td>
      <td class="gt_row gt_left">248738</td>
      <td class="gt_row gt_right">29.0000</td>
      <td class="gt_row gt_center">NaN</td>
      <td class="gt_row gt_left">S</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">392</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">3</td>
      <td class="gt_row gt_left">Jansson, Mr. Carl Olof</td>
      <td class="gt_row gt_left">male</td>
      <td class="gt_row gt_right">21.00</td>
      <td class="gt_row gt_right">0</td>
      <td class="gt_row gt_right">0</td>
      <td class="gt_row gt_left">350034</td>
      <td class="gt_row gt_right">7.7958</td>
      <td class="gt_row gt_center">NaN</td>
      <td class="gt_row gt_left">S</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">881</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">2</td>
      <td class="gt_row gt_left">Shelley, Mrs. William (Imanita Parrish Hall)</td>
      <td class="gt_row gt_left">female</td>
      <td class="gt_row gt_right">25.00</td>
      <td class="gt_row gt_right">0</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_left">230433</td>
      <td class="gt_row gt_right">26.0000</td>
      <td class="gt_row gt_center">NaN</td>
      <td class="gt_row gt_left">S</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">972</td>
      <td class="gt_row gt_right">NaN</td>
      <td class="gt_row gt_right">3</td>
      <td class="gt_row gt_left">Boulos, Master. Akar</td>
      <td class="gt_row gt_left">male</td>
      <td class="gt_row gt_right">6.00</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_left">2678</td>
      <td class="gt_row gt_right">15.2458</td>
      <td class="gt_row gt_center">NaN</td>
      <td class="gt_row gt_left">C</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">384</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_left">Holverson, Mrs. Alexander Oskar (Mary Aline Towner)</td>
      <td class="gt_row gt_left">female</td>
      <td class="gt_row gt_right">35.00</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">0</td>
      <td class="gt_row gt_left">113789</td>
      <td class="gt_row gt_right">52.0000</td>
      <td class="gt_row gt_center">NaN</td>
      <td class="gt_row gt_left">S</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">248</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">2</td>
      <td class="gt_row gt_left">Hamalainen, Mrs. William (Anna)</td>
      <td class="gt_row gt_left">female</td>
      <td class="gt_row gt_right">24.00</td>
      <td class="gt_row gt_right">0</td>
      <td class="gt_row gt_right">2</td>
      <td class="gt_row gt_left">250649</td>
      <td class="gt_row gt_right">14.5000</td>
      <td class="gt_row gt_center">NaN</td>
      <td class="gt_row gt_left">S</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">711</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_left">Mayne, Mlle. Berthe Antonine ("Mrs de Villiers")</td>
      <td class="gt_row gt_left">female</td>
      <td class="gt_row gt_right">24.00</td>
      <td class="gt_row gt_right">0</td>
      <td class="gt_row gt_right">0</td>
      <td class="gt_row gt_left">PC 17482</td>
      <td class="gt_row gt_right">49.5042</td>
      <td class="gt_row gt_center">C90</td>
      <td class="gt_row gt_left">C</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">527</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">2</td>
      <td class="gt_row gt_left">Ridsdale, Miss. Lucy</td>
      <td class="gt_row gt_left">female</td>
      <td class="gt_row gt_right">50.00</td>
      <td class="gt_row gt_right">0</td>
      <td class="gt_row gt_right">0</td>
      <td class="gt_row gt_left">W./C. 14258</td>
      <td class="gt_row gt_right">10.5000</td>
      <td class="gt_row gt_center">NaN</td>
      <td class="gt_row gt_left">S</td>
    </tr>
    <tr>
      <td class="gt_row gt_right">44</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">2</td>
      <td class="gt_row gt_left">Laroche, Miss. Simonne Marie Anne Andree</td>
      <td class="gt_row gt_left">female</td>
      <td class="gt_row gt_right">3.00</td>
      <td class="gt_row gt_right">1</td>
      <td class="gt_row gt_right">2</td>
      <td class="gt_row gt_left">SC/Paris 2123</td>
      <td class="gt_row gt_right">41.5792</td>
      <td class="gt_row gt_center">NaN</td>
      <td class="gt_row gt_left">C</td>
    </tr>
  </tbody>
  
  
</table></div>
<p>Print out the description of the data</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="titanic.html#cb4-1" aria-hidden="true"></a>df_describe_num <span class="op">=</span> <span class="bu">round</span>(df.describe(), <span class="dv">2</span>)</span>
<span id="cb4-2"><a href="titanic.html#cb4-2" aria-hidden="true"></a>df_describe_cat <span class="op">=</span> df.describe(include<span class="op">=</span><span class="st">&quot;O&quot;</span>).transpose()</span></code></pre></div>
<p><style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#fzansaabic .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fzansaabic .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fzansaabic .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fzansaabic .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fzansaabic .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fzansaabic .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fzansaabic .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 10;
  font-weight: bold;
  text-transform: capitalize;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fzansaabic .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 10;
  font-weight: bold;
  text-transform: capitalize;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fzansaabic .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fzansaabic .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fzansaabic .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fzansaabic .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#fzansaabic .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fzansaabic .gt_from_md > :first-child {
  margin-top: 0;
}

#fzansaabic .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fzansaabic .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fzansaabic .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#fzansaabic .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fzansaabic .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#fzansaabic .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fzansaabic .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fzansaabic .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fzansaabic .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fzansaabic .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fzansaabic .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#fzansaabic .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fzansaabic .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#fzansaabic .gt_left {
  text-align: left;
}

#fzansaabic .gt_center {
  text-align: center;
}

#fzansaabic .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fzansaabic .gt_font_normal {
  font-weight: normal;
}

#fzansaabic .gt_font_bold {
  font-weight: bold;
}

#fzansaabic .gt_font_italic {
  font-style: italic;
}

#fzansaabic .gt_super {
  font-size: 65%;
}

#fzansaabic .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="fzansaabic" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="8" class="gt_heading gt_title gt_font_normal" style><strong>Numerical Features</strong></th>
    </tr>
    <tr>
      <th colspan="8" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style><em>Description of the numerical features.</em></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">PassengerId</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Survived</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Pclass</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Age</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">SibSp</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Parch</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Fare</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left gt_stub">count</td>
      <td class="gt_row gt_right">1309.00</td>
      <td class="gt_row gt_right">891.00</td>
      <td class="gt_row gt_right">1309.00</td>
      <td class="gt_row gt_right">1046.00</td>
      <td class="gt_row gt_right">1309.00</td>
      <td class="gt_row gt_right">1309.00</td>
      <td class="gt_row gt_right">1308.00</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">mean</td>
      <td class="gt_row gt_right">655.00</td>
      <td class="gt_row gt_right">0.38</td>
      <td class="gt_row gt_right">2.29</td>
      <td class="gt_row gt_right">29.88</td>
      <td class="gt_row gt_right">0.50</td>
      <td class="gt_row gt_right">0.39</td>
      <td class="gt_row gt_right">33.30</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">std</td>
      <td class="gt_row gt_right">378.02</td>
      <td class="gt_row gt_right">0.49</td>
      <td class="gt_row gt_right">0.84</td>
      <td class="gt_row gt_right">14.41</td>
      <td class="gt_row gt_right">1.04</td>
      <td class="gt_row gt_right">0.87</td>
      <td class="gt_row gt_right">51.76</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">min</td>
      <td class="gt_row gt_right">1.00</td>
      <td class="gt_row gt_right">0.00</td>
      <td class="gt_row gt_right">1.00</td>
      <td class="gt_row gt_right">0.17</td>
      <td class="gt_row gt_right">0.00</td>
      <td class="gt_row gt_right">0.00</td>
      <td class="gt_row gt_right">0.00</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">25%</td>
      <td class="gt_row gt_right">328.00</td>
      <td class="gt_row gt_right">0.00</td>
      <td class="gt_row gt_right">2.00</td>
      <td class="gt_row gt_right">21.00</td>
      <td class="gt_row gt_right">0.00</td>
      <td class="gt_row gt_right">0.00</td>
      <td class="gt_row gt_right">7.90</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">50%</td>
      <td class="gt_row gt_right">655.00</td>
      <td class="gt_row gt_right">0.00</td>
      <td class="gt_row gt_right">3.00</td>
      <td class="gt_row gt_right">28.00</td>
      <td class="gt_row gt_right">0.00</td>
      <td class="gt_row gt_right">0.00</td>
      <td class="gt_row gt_right">14.45</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">75%</td>
      <td class="gt_row gt_right">982.00</td>
      <td class="gt_row gt_right">1.00</td>
      <td class="gt_row gt_right">3.00</td>
      <td class="gt_row gt_right">39.00</td>
      <td class="gt_row gt_right">1.00</td>
      <td class="gt_row gt_right">0.00</td>
      <td class="gt_row gt_right">31.28</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">max</td>
      <td class="gt_row gt_right">1309.00</td>
      <td class="gt_row gt_right">1.00</td>
      <td class="gt_row gt_right">3.00</td>
      <td class="gt_row gt_right">80.00</td>
      <td class="gt_row gt_right">8.00</td>
      <td class="gt_row gt_right">9.00</td>
      <td class="gt_row gt_right">512.33</td>
    </tr>
  </tbody>
  
  
</table></div><style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pmsnvjlenr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pmsnvjlenr .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pmsnvjlenr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pmsnvjlenr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pmsnvjlenr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pmsnvjlenr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pmsnvjlenr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 10;
  font-weight: bold;
  text-transform: capitalize;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pmsnvjlenr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 10;
  font-weight: bold;
  text-transform: capitalize;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pmsnvjlenr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pmsnvjlenr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pmsnvjlenr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pmsnvjlenr .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#pmsnvjlenr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pmsnvjlenr .gt_from_md > :first-child {
  margin-top: 0;
}

#pmsnvjlenr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pmsnvjlenr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pmsnvjlenr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#pmsnvjlenr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pmsnvjlenr .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#pmsnvjlenr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pmsnvjlenr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pmsnvjlenr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pmsnvjlenr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pmsnvjlenr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pmsnvjlenr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#pmsnvjlenr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pmsnvjlenr .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#pmsnvjlenr .gt_left {
  text-align: left;
}

#pmsnvjlenr .gt_center {
  text-align: center;
}

#pmsnvjlenr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pmsnvjlenr .gt_font_normal {
  font-weight: normal;
}

#pmsnvjlenr .gt_font_bold {
  font-weight: bold;
}

#pmsnvjlenr .gt_font_italic {
  font-style: italic;
}

#pmsnvjlenr .gt_super {
  font-size: 65%;
}

#pmsnvjlenr .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="pmsnvjlenr" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="5" class="gt_heading gt_title gt_font_normal" style><strong>Categorical Features</strong></th>
    </tr>
    <tr>
      <th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style><em>Description of the categorical features.</em></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">count</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">unique</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">top</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">freq</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left gt_stub">Name</td>
      <td class="gt_row gt_center">1309</td>
      <td class="gt_row gt_center">1307</td>
      <td class="gt_row gt_left">Connolly, Miss. Kate</td>
      <td class="gt_row gt_center">2</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">Sex</td>
      <td class="gt_row gt_center">1309</td>
      <td class="gt_row gt_center">2</td>
      <td class="gt_row gt_left">male</td>
      <td class="gt_row gt_center">843</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">Ticket</td>
      <td class="gt_row gt_center">1309</td>
      <td class="gt_row gt_center">929</td>
      <td class="gt_row gt_left">CA. 2343</td>
      <td class="gt_row gt_center">11</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">Cabin</td>
      <td class="gt_row gt_center">295</td>
      <td class="gt_row gt_center">186</td>
      <td class="gt_row gt_left">C23 C25 C27</td>
      <td class="gt_row gt_center">6</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">Embarked</td>
      <td class="gt_row gt_center">1307</td>
      <td class="gt_row gt_center">3</td>
      <td class="gt_row gt_left">S</td>
      <td class="gt_row gt_center">914</td>
    </tr>
  </tbody>
  
  
</table></div></p>
</div>
<div id="eda" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> EDA</h2>
<div id="missing-data" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Missing Data</h3>
<p>Show missing data in a clear heatmap.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="titanic.html#cb5-1" aria-hidden="true"></a>f, ax <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">1</span>, ncols<span class="op">=</span><span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">10</span>))</span>
<span id="cb5-2"><a href="titanic.html#cb5-2" aria-hidden="true"></a>sns.heatmap(df.isnull(), </span>
<span id="cb5-3"><a href="titanic.html#cb5-3" aria-hidden="true"></a>        yticklabels<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb5-4"><a href="titanic.html#cb5-4" aria-hidden="true"></a>        cbar<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb5-5"><a href="titanic.html#cb5-5" aria-hidden="true"></a>        cmap<span class="op">=</span><span class="st">&quot;Blues&quot;</span></span>
<span id="cb5-6"><a href="titanic.html#cb5-6" aria-hidden="true"></a>        )</span>
<span id="cb5-7"><a href="titanic.html#cb5-7" aria-hidden="true"></a>ax.set_title(<span class="st">&#39;Fields with Missing Values&#39;</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb5-8"><a href="titanic.html#cb5-8" aria-hidden="true"></a><span class="cf">for</span> tick <span class="kw">in</span> ax.yaxis.get_major_ticks():</span>
<span id="cb5-9"><a href="titanic.html#cb5-9" aria-hidden="true"></a>    tick.label.set_fontsize(<span class="dv">14</span>)</span>
<span id="cb5-10"><a href="titanic.html#cb5-10" aria-hidden="true"></a></span>
<span id="cb5-11"><a href="titanic.html#cb5-11" aria-hidden="true"></a>plt.savefig(<span class="st">&quot;01_missing_data_heatmap&quot;</span>)</span>
<span id="cb5-12"><a href="titanic.html#cb5-12" aria-hidden="true"></a>plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-1.png" width="1152" /></p>
<p>Show the specific values.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="titanic.html#cb6-1" aria-hidden="true"></a><span class="kw">def</span> missing_only(value):</span>
<span id="cb6-2"><a href="titanic.html#cb6-2" aria-hidden="true"></a>    <span class="cf">if</span> value <span class="op">==</span> <span class="dv">0</span> : <span class="cf">return</span> np.nan</span>
<span id="cb6-3"><a href="titanic.html#cb6-3" aria-hidden="true"></a>    <span class="cf">else</span>: <span class="cf">return</span> value</span>
<span id="cb6-4"><a href="titanic.html#cb6-4" aria-hidden="true"></a></span>
<span id="cb6-5"><a href="titanic.html#cb6-5" aria-hidden="true"></a>missing_values <span class="op">=</span> pd.DataFrame()</span>
<span id="cb6-6"><a href="titanic.html#cb6-6" aria-hidden="true"></a>missing_values[<span class="st">&#39;Percentage&#39;</span>] <span class="op">=</span> np.<span class="bu">round</span>((df.isna().<span class="bu">sum</span>() <span class="op">/</span> df.count().<span class="bu">max</span>()) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> value: missing_only(value)).dropna()</span>
<span id="cb6-7"><a href="titanic.html#cb6-7" aria-hidden="true"></a>missing_values[<span class="st">&#39;Counts&#39;</span>]     <span class="op">=</span> np.<span class="bu">round</span>(df.isna().<span class="bu">sum</span>(), <span class="dv">2</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> value: missing_only(value)).dropna()</span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#xprpfkqnpf .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xprpfkqnpf .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xprpfkqnpf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xprpfkqnpf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xprpfkqnpf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xprpfkqnpf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xprpfkqnpf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 10;
  font-weight: bold;
  text-transform: capitalize;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xprpfkqnpf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 10;
  font-weight: bold;
  text-transform: capitalize;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xprpfkqnpf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xprpfkqnpf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xprpfkqnpf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xprpfkqnpf .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#xprpfkqnpf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xprpfkqnpf .gt_from_md > :first-child {
  margin-top: 0;
}

#xprpfkqnpf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xprpfkqnpf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xprpfkqnpf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#xprpfkqnpf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xprpfkqnpf .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#xprpfkqnpf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xprpfkqnpf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xprpfkqnpf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xprpfkqnpf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xprpfkqnpf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xprpfkqnpf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#xprpfkqnpf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xprpfkqnpf .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#xprpfkqnpf .gt_left {
  text-align: left;
}

#xprpfkqnpf .gt_center {
  text-align: center;
}

#xprpfkqnpf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xprpfkqnpf .gt_font_normal {
  font-weight: normal;
}

#xprpfkqnpf .gt_font_bold {
  font-weight: bold;
}

#xprpfkqnpf .gt_font_italic {
  font-style: italic;
}

#xprpfkqnpf .gt_super {
  font-size: 65%;
}

#xprpfkqnpf .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="xprpfkqnpf" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="3" class="gt_heading gt_title gt_font_normal" style><strong>Missing values</strong></th>
    </tr>
    <tr>
      <th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style><em>Missing values only on features with missing values.</em></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Percentage</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Counts</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left gt_stub">Survived</td>
      <td class="gt_row gt_right">31.93</td>
      <td class="gt_row gt_right">418</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">Age</td>
      <td class="gt_row gt_right">20.09</td>
      <td class="gt_row gt_right">263</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">Fare</td>
      <td class="gt_row gt_right">0.08</td>
      <td class="gt_row gt_right">1</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">Cabin</td>
      <td class="gt_row gt_right">77.46</td>
      <td class="gt_row gt_right">1014</td>
    </tr>
    <tr>
      <td class="gt_row gt_left gt_stub">Embarked</td>
      <td class="gt_row gt_right">0.15</td>
      <td class="gt_row gt_right">2</td>
    </tr>
  </tbody>
  
  
</table></div>
</div>
<div id="correlation" class="section level3" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Correlation</h3>
<p>Show the correlation between the survival rate and the other features.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="titanic.html#cb7-1" aria-hidden="true"></a>TARGET <span class="op">=</span> <span class="st">&quot;Survived&quot;</span></span>
<span id="cb7-2"><a href="titanic.html#cb7-2" aria-hidden="true"></a></span>
<span id="cb7-3"><a href="titanic.html#cb7-3" aria-hidden="true"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">8</span>))</span>
<span id="cb7-4"><a href="titanic.html#cb7-4" aria-hidden="true"></a>df.corr()[TARGET].sort_values()[:<span class="op">-</span><span class="dv">1</span>].plot(kind<span class="op">=</span><span class="st">&quot;bar&quot;</span>)</span>
<span id="cb7-5"><a href="titanic.html#cb7-5" aria-hidden="true"></a>plt.savefig(<span class="st">&quot;correlation_barplot&quot;</span>)</span>
<span id="cb7-6"><a href="titanic.html#cb7-6" aria-hidden="true"></a>plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-11-1.png" width="1344" /></p>
<p>Show the correlation between all features.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="titanic.html#cb8-1" aria-hidden="true"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">12</span>))</span>
<span id="cb8-2"><a href="titanic.html#cb8-2" aria-hidden="true"></a>plt.title(<span class="st">&#39;Correlation of Features&#39;</span>, y<span class="op">=</span><span class="fl">1.05</span>, size<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb8-3"><a href="titanic.html#cb8-3" aria-hidden="true"></a>mask <span class="op">=</span> np.zeros_like(df.corr())</span>
<span id="cb8-4"><a href="titanic.html#cb8-4" aria-hidden="true"></a>mask[np.triu_indices_from(mask)] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb8-5"><a href="titanic.html#cb8-5" aria-hidden="true"></a>sns.heatmap(</span>
<span id="cb8-6"><a href="titanic.html#cb8-6" aria-hidden="true"></a>    df.corr(),</span>
<span id="cb8-7"><a href="titanic.html#cb8-7" aria-hidden="true"></a>    annot<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-8"><a href="titanic.html#cb8-8" aria-hidden="true"></a>    linewidths<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb8-9"><a href="titanic.html#cb8-9" aria-hidden="true"></a>    linecolor<span class="op">=</span><span class="st">&#39;white&#39;</span>,</span>
<span id="cb8-10"><a href="titanic.html#cb8-10" aria-hidden="true"></a>    cmap<span class="op">=</span><span class="st">&quot;RdBu&quot;</span>,</span>
<span id="cb8-11"><a href="titanic.html#cb8-11" aria-hidden="true"></a>    center<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb8-12"><a href="titanic.html#cb8-12" aria-hidden="true"></a>    mask<span class="op">=</span>mask,</span>
<span id="cb8-13"><a href="titanic.html#cb8-13" aria-hidden="true"></a>    vmax<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb8-14"><a href="titanic.html#cb8-14" aria-hidden="true"></a>    vmin<span class="op">=-</span><span class="fl">1.0</span>,</span>
<span id="cb8-15"><a href="titanic.html#cb8-15" aria-hidden="true"></a>    square<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb8-16"><a href="titanic.html#cb8-16" aria-hidden="true"></a>)</span>
<span id="cb8-17"><a href="titanic.html#cb8-17" aria-hidden="true"></a>plt.savefig(<span class="st">&quot;correlation_map&quot;</span>)</span>
<span id="cb8-18"><a href="titanic.html#cb8-18" aria-hidden="true"></a>plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-12-1.png" width="1344" /></p>
</div>
<div id="pivot-features" class="section level3" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Pivot Features</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="titanic.html#cb9-1" aria-hidden="true"></a><span class="kw">def</span> pivot_feature(df, TARGET, FEATURE):</span>
<span id="cb9-2"><a href="titanic.html#cb9-2" aria-hidden="true"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb9-3"><a href="titanic.html#cb9-3" aria-hidden="true"></a><span class="co">    Input the</span></span>
<span id="cb9-4"><a href="titanic.html#cb9-4" aria-hidden="true"></a><span class="co">    - data frame</span></span>
<span id="cb9-5"><a href="titanic.html#cb9-5" aria-hidden="true"></a><span class="co">    - target feature</span></span>
<span id="cb9-6"><a href="titanic.html#cb9-6" aria-hidden="true"></a><span class="co">    - relevant feature (only for features which are categorical (Sex),</span></span>
<span id="cb9-7"><a href="titanic.html#cb9-7" aria-hidden="true"></a><span class="co">    ordinal (Passenger class) or discrete (Sibbling count)).</span></span>
<span id="cb9-8"><a href="titanic.html#cb9-8" aria-hidden="true"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb9-9"><a href="titanic.html#cb9-9" aria-hidden="true"></a>    <span class="cf">return</span> (df[[FEATURE, TARGET</span>
<span id="cb9-10"><a href="titanic.html#cb9-10" aria-hidden="true"></a>                ]].groupby([FEATURE]).mean().sort_values(by<span class="op">=</span>FEATURE,</span>
<span id="cb9-11"><a href="titanic.html#cb9-11" aria-hidden="true"></a>                                                         ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb9-12"><a href="titanic.html#cb9-12" aria-hidden="true"></a></span>
<span id="cb9-13"><a href="titanic.html#cb9-13" aria-hidden="true"></a>pivot_feature(df, <span class="st">&quot;Survived&quot;</span>, <span class="st">&quot;Pclass&quot;</span>)</span></code></pre></div>
<pre><code>##         Survived
## Pclass          
## 3       0.242363
## 2       0.472826
## 1       0.629630</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="titanic.html#cb11-1" aria-hidden="true"></a>pivot_feature(df, <span class="st">&quot;Survived&quot;</span>, <span class="st">&quot;Sex&quot;</span>)</span></code></pre></div>
<pre><code>##         Survived
## Sex             
## male    0.188908
## female  0.742038</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="titanic.html#cb13-1" aria-hidden="true"></a>pivot_feature(df, <span class="st">&quot;Survived&quot;</span>, <span class="st">&quot;SibSp&quot;</span>)</span></code></pre></div>
<pre><code>##        Survived
## SibSp          
## 8      0.000000
## 5      0.000000
## 4      0.166667
## 3      0.250000
## 2      0.464286
## 1      0.535885
## 0      0.345395</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="titanic.html#cb15-1" aria-hidden="true"></a>pivot_feature(df, <span class="st">&quot;Survived&quot;</span>, <span class="st">&quot;Parch&quot;</span>)</span></code></pre></div>
<pre><code>##        Survived
## Parch          
## 9           NaN
## 6      0.000000
## 5      0.200000
## 4      0.000000
## 3      0.600000
## 2      0.500000
## 1      0.550847
## 0      0.343658</code></pre>
</div>
</div>
<div id="visualization" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Visualization</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="titanic.html#cb17-1" aria-hidden="true"></a><span class="kw">def</span> plot_corr_numerical(df, TARGET, FEATURE):</span>
<span id="cb17-2"><a href="titanic.html#cb17-2" aria-hidden="true"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb17-3"><a href="titanic.html#cb17-3" aria-hidden="true"></a><span class="co">    Data Frame</span></span>
<span id="cb17-4"><a href="titanic.html#cb17-4" aria-hidden="true"></a><span class="co">    Target feature</span></span>
<span id="cb17-5"><a href="titanic.html#cb17-5" aria-hidden="true"></a><span class="co">    Feature of intrest</span></span>
<span id="cb17-6"><a href="titanic.html#cb17-6" aria-hidden="true"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb17-7"><a href="titanic.html#cb17-7" aria-hidden="true"></a>    g <span class="op">=</span> sns.FacetGrid(df, col<span class="op">=</span>TARGET)</span>
<span id="cb17-8"><a href="titanic.html#cb17-8" aria-hidden="true"></a>    g.<span class="bu">map</span>(plt.hist, FEATURE, bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb17-9"><a href="titanic.html#cb17-9" aria-hidden="true"></a>    plt.savefig(<span class="st">&quot;04_corr_numerical_&quot;</span> <span class="op">+</span> TARGET <span class="op">+</span> <span class="st">&quot;_&quot;</span> <span class="op">+</span> FEATURE)</span>
<span id="cb17-10"><a href="titanic.html#cb17-10" aria-hidden="true"></a>    plt.show()</span>
<span id="cb17-11"><a href="titanic.html#cb17-11" aria-hidden="true"></a></span>
<span id="cb17-12"><a href="titanic.html#cb17-12" aria-hidden="true"></a></span>
<span id="cb17-13"><a href="titanic.html#cb17-13" aria-hidden="true"></a>plot_corr_numerical(df, <span class="st">&quot;Survived&quot;</span>, <span class="st">&quot;Age&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-14-1.png" width="576" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="titanic.html#cb18-1" aria-hidden="true"></a><span class="kw">def</span> plot_corr_num_ord(df, TARGET, numerical_FEATURE, ordinal_FEATURE):</span>
<span id="cb18-2"><a href="titanic.html#cb18-2" aria-hidden="true"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb18-3"><a href="titanic.html#cb18-3" aria-hidden="true"></a><span class="co">    Data Frame</span></span>
<span id="cb18-4"><a href="titanic.html#cb18-4" aria-hidden="true"></a><span class="co">    Target feature</span></span>
<span id="cb18-5"><a href="titanic.html#cb18-5" aria-hidden="true"></a><span class="co">    numerical feature of intrest</span></span>
<span id="cb18-6"><a href="titanic.html#cb18-6" aria-hidden="true"></a><span class="co">    ordinal feature of intrest</span></span>
<span id="cb18-7"><a href="titanic.html#cb18-7" aria-hidden="true"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb18-8"><a href="titanic.html#cb18-8" aria-hidden="true"></a>    g <span class="op">=</span> sns.FacetGrid(df,</span>
<span id="cb18-9"><a href="titanic.html#cb18-9" aria-hidden="true"></a>                      col<span class="op">=</span>TARGET,</span>
<span id="cb18-10"><a href="titanic.html#cb18-10" aria-hidden="true"></a>                      row<span class="op">=</span>ordinal_FEATURE,</span>
<span id="cb18-11"><a href="titanic.html#cb18-11" aria-hidden="true"></a>                      size<span class="op">=</span><span class="fl">2.2</span>,</span>
<span id="cb18-12"><a href="titanic.html#cb18-12" aria-hidden="true"></a>                      aspect<span class="op">=</span><span class="fl">1.6</span>)</span>
<span id="cb18-13"><a href="titanic.html#cb18-13" aria-hidden="true"></a>    g.<span class="bu">map</span>(plt.hist, numerical_FEATURE, alpha<span class="op">=</span><span class="fl">0.5</span>, bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb18-14"><a href="titanic.html#cb18-14" aria-hidden="true"></a>    g.add_legend()</span>
<span id="cb18-15"><a href="titanic.html#cb18-15" aria-hidden="true"></a>    plt.savefig(<span class="st">&quot;04_corr_num_ord_&quot;</span> <span class="op">+</span> TARGET <span class="op">+</span> <span class="st">&quot;_&quot;</span> <span class="op">+</span> numerical_FEATURE <span class="op">+</span> <span class="st">&quot;_&quot;</span> <span class="op">+</span></span>
<span id="cb18-16"><a href="titanic.html#cb18-16" aria-hidden="true"></a>                ordinal_FEATURE)</span>
<span id="cb18-17"><a href="titanic.html#cb18-17" aria-hidden="true"></a>    plt.show()</span>
<span id="cb18-18"><a href="titanic.html#cb18-18" aria-hidden="true"></a></span>
<span id="cb18-19"><a href="titanic.html#cb18-19" aria-hidden="true"></a></span>
<span id="cb18-20"><a href="titanic.html#cb18-20" aria-hidden="true"></a>plot_corr_num_ord(df, <span class="st">&quot;Survived&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Pclass&quot;</span>)</span></code></pre></div>
<pre><code>## /nix/store/lz8yaf1c80c6zb3qj11j58x3qq366wxx-python3.8-seaborn-0.11.0/lib/python3.8/site-packages/seaborn/axisgrid.py:316: UserWarning: The `size` parameter has been renamed to `height`; please update your code.
##   warnings.warn(msg, UserWarning)</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-14-2.png" width="686" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="titanic.html#cb20-1" aria-hidden="true"></a><span class="kw">def</span> plot_corr_cat(</span>
<span id="cb20-2"><a href="titanic.html#cb20-2" aria-hidden="true"></a>    df,</span>
<span id="cb20-3"><a href="titanic.html#cb20-3" aria-hidden="true"></a>    TARGET,</span>
<span id="cb20-4"><a href="titanic.html#cb20-4" aria-hidden="true"></a>    categorical_FEATURE,</span>
<span id="cb20-5"><a href="titanic.html#cb20-5" aria-hidden="true"></a>    categorical_FEATURE_x_axis,</span>
<span id="cb20-6"><a href="titanic.html#cb20-6" aria-hidden="true"></a>    categorical_FEATURE_new_line,</span>
<span id="cb20-7"><a href="titanic.html#cb20-7" aria-hidden="true"></a>):</span>
<span id="cb20-8"><a href="titanic.html#cb20-8" aria-hidden="true"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb20-9"><a href="titanic.html#cb20-9" aria-hidden="true"></a><span class="co">    Data Frame</span></span>
<span id="cb20-10"><a href="titanic.html#cb20-10" aria-hidden="true"></a><span class="co">    Target feature - y axis</span></span>
<span id="cb20-11"><a href="titanic.html#cb20-11" aria-hidden="true"></a><span class="co">    categorical feature - facet row</span></span>
<span id="cb20-12"><a href="titanic.html#cb20-12" aria-hidden="true"></a><span class="co">    feature of intrest</span></span>
<span id="cb20-13"><a href="titanic.html#cb20-13" aria-hidden="true"></a><span class="co">    feature of intrest</span></span>
<span id="cb20-14"><a href="titanic.html#cb20-14" aria-hidden="true"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb20-15"><a href="titanic.html#cb20-15" aria-hidden="true"></a>    g <span class="op">=</span> sns.FacetGrid(df, row<span class="op">=</span>categorical_FEATURE, size<span class="op">=</span><span class="fl">2.2</span>, aspect<span class="op">=</span><span class="fl">1.6</span>)</span>
<span id="cb20-16"><a href="titanic.html#cb20-16" aria-hidden="true"></a>    g.<span class="bu">map</span>(</span>
<span id="cb20-17"><a href="titanic.html#cb20-17" aria-hidden="true"></a>        sns.pointplot,</span>
<span id="cb20-18"><a href="titanic.html#cb20-18" aria-hidden="true"></a>        categorical_FEATURE_x_axis,</span>
<span id="cb20-19"><a href="titanic.html#cb20-19" aria-hidden="true"></a>        TARGET,</span>
<span id="cb20-20"><a href="titanic.html#cb20-20" aria-hidden="true"></a>        categorical_FEATURE_new_line,</span>
<span id="cb20-21"><a href="titanic.html#cb20-21" aria-hidden="true"></a>        palette<span class="op">=</span><span class="st">&quot;deep&quot;</span>,</span>
<span id="cb20-22"><a href="titanic.html#cb20-22" aria-hidden="true"></a>    )</span>
<span id="cb20-23"><a href="titanic.html#cb20-23" aria-hidden="true"></a>    g.add_legend()</span>
<span id="cb20-24"><a href="titanic.html#cb20-24" aria-hidden="true"></a>    plt.savefig(<span class="st">&quot;04_corr_cat_&quot;</span> <span class="op">+</span> TARGET <span class="op">+</span> <span class="st">&quot;_&quot;</span> <span class="op">+</span> categorical_FEATURE_x_axis <span class="op">+</span></span>
<span id="cb20-25"><a href="titanic.html#cb20-25" aria-hidden="true"></a>                <span class="st">&quot;_&quot;</span> <span class="op">+</span> categorical_FEATURE_new_line)</span>
<span id="cb20-26"><a href="titanic.html#cb20-26" aria-hidden="true"></a></span>
<span id="cb20-27"><a href="titanic.html#cb20-27" aria-hidden="true"></a>plot_corr_cat(df, <span class="st">&quot;Survived&quot;</span>, <span class="st">&quot;Embarked&quot;</span>, <span class="st">&quot;Pclass&quot;</span>, <span class="st">&quot;Sex&quot;</span>)</span></code></pre></div>
<pre><code>## /nix/store/lz8yaf1c80c6zb3qj11j58x3qq366wxx-python3.8-seaborn-0.11.0/lib/python3.8/site-packages/seaborn/axisgrid.py:316: UserWarning: The `size` parameter has been renamed to `height`; please update your code.
##   warnings.warn(msg, UserWarning)
## /nix/store/lz8yaf1c80c6zb3qj11j58x3qq366wxx-python3.8-seaborn-0.11.0/lib/python3.8/site-packages/seaborn/axisgrid.py:645: UserWarning: Using the pointplot function without specifying `order` is likely to produce an incorrect plot.
##   warnings.warn(warning)
## /nix/store/lz8yaf1c80c6zb3qj11j58x3qq366wxx-python3.8-seaborn-0.11.0/lib/python3.8/site-packages/seaborn/axisgrid.py:650: UserWarning: Using the pointplot function without specifying `hue_order` is likely to produce an incorrect plot.
##   warnings.warn(warning)</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="titanic.html#cb22-1" aria-hidden="true"></a><span class="kw">def</span> plot_corr_cat_num(</span>
<span id="cb22-2"><a href="titanic.html#cb22-2" aria-hidden="true"></a>    df,</span>
<span id="cb22-3"><a href="titanic.html#cb22-3" aria-hidden="true"></a>    TARGET,</span>
<span id="cb22-4"><a href="titanic.html#cb22-4" aria-hidden="true"></a>    categorical_FEATURE_facet_row,</span>
<span id="cb22-5"><a href="titanic.html#cb22-5" aria-hidden="true"></a>    categorical_FEATURE_y_axis,</span>
<span id="cb22-6"><a href="titanic.html#cb22-6" aria-hidden="true"></a>    categorical_FEATURE_x_axis,</span>
<span id="cb22-7"><a href="titanic.html#cb22-7" aria-hidden="true"></a>):</span>
<span id="cb22-8"><a href="titanic.html#cb22-8" aria-hidden="true"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb22-9"><a href="titanic.html#cb22-9" aria-hidden="true"></a><span class="co">    Data Frame</span></span>
<span id="cb22-10"><a href="titanic.html#cb22-10" aria-hidden="true"></a><span class="co">    Target feature - y axis</span></span>
<span id="cb22-11"><a href="titanic.html#cb22-11" aria-hidden="true"></a><span class="co">    categorical feature - facet row</span></span>
<span id="cb22-12"><a href="titanic.html#cb22-12" aria-hidden="true"></a><span class="co">    feature of intrest</span></span>
<span id="cb22-13"><a href="titanic.html#cb22-13" aria-hidden="true"></a><span class="co">    feature of intrest</span></span>
<span id="cb22-14"><a href="titanic.html#cb22-14" aria-hidden="true"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb22-15"><a href="titanic.html#cb22-15" aria-hidden="true"></a>    g <span class="op">=</span> sns.FacetGrid(df,</span>
<span id="cb22-16"><a href="titanic.html#cb22-16" aria-hidden="true"></a>                      row<span class="op">=</span>categorical_FEATURE_facet_row,</span>
<span id="cb22-17"><a href="titanic.html#cb22-17" aria-hidden="true"></a>                      col<span class="op">=</span>TARGET,</span>
<span id="cb22-18"><a href="titanic.html#cb22-18" aria-hidden="true"></a>                      size<span class="op">=</span><span class="fl">2.2</span>,</span>
<span id="cb22-19"><a href="titanic.html#cb22-19" aria-hidden="true"></a>                      aspect<span class="op">=</span><span class="fl">1.6</span>)</span>
<span id="cb22-20"><a href="titanic.html#cb22-20" aria-hidden="true"></a>    g.<span class="bu">map</span>(</span>
<span id="cb22-21"><a href="titanic.html#cb22-21" aria-hidden="true"></a>        sns.barplot,</span>
<span id="cb22-22"><a href="titanic.html#cb22-22" aria-hidden="true"></a>        categorical_FEATURE_x_axis,</span>
<span id="cb22-23"><a href="titanic.html#cb22-23" aria-hidden="true"></a>        categorical_FEATURE_y_axis,</span>
<span id="cb22-24"><a href="titanic.html#cb22-24" aria-hidden="true"></a>        palette<span class="op">=</span><span class="st">&quot;deep&quot;</span>,</span>
<span id="cb22-25"><a href="titanic.html#cb22-25" aria-hidden="true"></a>        alpha<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb22-26"><a href="titanic.html#cb22-26" aria-hidden="true"></a>        ci<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb22-27"><a href="titanic.html#cb22-27" aria-hidden="true"></a>    )</span>
<span id="cb22-28"><a href="titanic.html#cb22-28" aria-hidden="true"></a>    g.add_legend()</span>
<span id="cb22-29"><a href="titanic.html#cb22-29" aria-hidden="true"></a>    plt.savefig(<span class="st">&quot;04_corr_cat_num_&quot;</span> <span class="op">+</span> TARGET <span class="op">+</span> <span class="st">&quot;_&quot;</span> <span class="op">+</span></span>
<span id="cb22-30"><a href="titanic.html#cb22-30" aria-hidden="true"></a>                categorical_FEATURE_x_axis <span class="op">+</span> <span class="st">&quot;_&quot;</span> <span class="op">+</span> categorical_FEATURE_y_axis)</span>
<span id="cb22-31"><a href="titanic.html#cb22-31" aria-hidden="true"></a>    plt.show()</span>
<span id="cb22-32"><a href="titanic.html#cb22-32" aria-hidden="true"></a></span>
<span id="cb22-33"><a href="titanic.html#cb22-33" aria-hidden="true"></a></span>
<span id="cb22-34"><a href="titanic.html#cb22-34" aria-hidden="true"></a>plot_corr_cat_num(df, <span class="st">&quot;Survived&quot;</span>, <span class="st">&quot;Embarked&quot;</span>, <span class="st">&quot;Fare&quot;</span>, <span class="st">&quot;Sex&quot;</span>)</span></code></pre></div>
<pre><code>## /nix/store/lz8yaf1c80c6zb3qj11j58x3qq366wxx-python3.8-seaborn-0.11.0/lib/python3.8/site-packages/seaborn/axisgrid.py:316: UserWarning: The `size` parameter has been renamed to `height`; please update your code.
##   warnings.warn(msg, UserWarning)
## /nix/store/lz8yaf1c80c6zb3qj11j58x3qq366wxx-python3.8-seaborn-0.11.0/lib/python3.8/site-packages/seaborn/axisgrid.py:645: UserWarning: Using the barplot function without specifying `order` is likely to produce an incorrect plot.
##   warnings.warn(warning)</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-14-3.png" width="686" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="titanic.html#cb24-1" aria-hidden="true"></a>df.drop([<span class="st">&quot;Ticket&quot;</span>, <span class="st">&quot;Cabin&quot;</span>, <span class="st">&quot;PassengerId&quot;</span>], inplace<span class="op">=</span><span class="va">True</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div id="feature-engineering" class="section level3" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Feature Engineering</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="titanic.html#cb25-1" aria-hidden="true"></a>df[<span class="st">&quot;Title&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;Name&quot;</span>].<span class="bu">str</span>.extract(<span class="st">&quot; ([A-Za-z]+)\.&quot;</span>,</span>
<span id="cb25-2"><a href="titanic.html#cb25-2" aria-hidden="true"></a>                                     expand<span class="op">=</span><span class="va">False</span>)  <span class="co">## get word before the .</span></span>
<span id="cb25-3"><a href="titanic.html#cb25-3" aria-hidden="true"></a></span>
<span id="cb25-4"><a href="titanic.html#cb25-4" aria-hidden="true"></a>pd.crosstab(df[<span class="st">&quot;Title&quot;</span>], df[<span class="st">&quot;Sex&quot;</span>])</span></code></pre></div>
<pre><code>## Sex       female  male
## Title                 
## Capt           0     1
## Col            0     4
## Countess       1     0
## Don            0     1
## Dona           1     0
## Dr             1     7
## Jonkheer       0     1
## Lady           1     0
## Major          0     2
## Master         0    61
## Miss         260     0
## Mlle           2     0
## Mme            1     0
## Mr             0   757
## Mrs          197     0
## Ms             2     0
## Rev            0     8
## Sir            0     1</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="titanic.html#cb27-1" aria-hidden="true"></a>df[<span class="st">&quot;Title&quot;</span>].unique()</span></code></pre></div>
<pre><code>## array([&#39;Mr&#39;, &#39;Mrs&#39;, &#39;Miss&#39;, &#39;Master&#39;, &#39;Don&#39;, &#39;Rev&#39;, &#39;Dr&#39;, &#39;Mme&#39;, &#39;Ms&#39;,
##        &#39;Major&#39;, &#39;Lady&#39;, &#39;Sir&#39;, &#39;Mlle&#39;, &#39;Col&#39;, &#39;Capt&#39;, &#39;Countess&#39;,
##        &#39;Jonkheer&#39;, &#39;Dona&#39;], dtype=object)</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="titanic.html#cb29-1" aria-hidden="true"></a><span class="kw">def</span> repace_values_with(df, FEATURE, LIST, REPLACE_WITH):</span>
<span id="cb29-2"><a href="titanic.html#cb29-2" aria-hidden="true"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb29-3"><a href="titanic.html#cb29-3" aria-hidden="true"></a><span class="co">    Replace values in a column with ...</span></span>
<span id="cb29-4"><a href="titanic.html#cb29-4" aria-hidden="true"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb29-5"><a href="titanic.html#cb29-5" aria-hidden="true"></a>    df[FEATURE] <span class="op">=</span> df[FEATURE].replace(LIST, REPLACE_WITH)</span>
<span id="cb29-6"><a href="titanic.html#cb29-6" aria-hidden="true"></a></span>
<span id="cb29-7"><a href="titanic.html#cb29-7" aria-hidden="true"></a>repace_values_with(</span>
<span id="cb29-8"><a href="titanic.html#cb29-8" aria-hidden="true"></a>    df,</span>
<span id="cb29-9"><a href="titanic.html#cb29-9" aria-hidden="true"></a>    <span class="st">&quot;Title&quot;</span>,</span>
<span id="cb29-10"><a href="titanic.html#cb29-10" aria-hidden="true"></a>    [</span>
<span id="cb29-11"><a href="titanic.html#cb29-11" aria-hidden="true"></a>        <span class="st">&quot;Don&quot;</span>, <span class="st">&quot;Rev&quot;</span>, <span class="st">&quot;Dr&quot;</span>, <span class="st">&quot;Major&quot;</span>, <span class="st">&quot;Lady&quot;</span>, <span class="st">&quot;Sir&quot;</span>, <span class="st">&quot;Col&quot;</span>, <span class="st">&quot;Capt&quot;</span>, <span class="st">&quot;Countess&quot;</span>,</span>
<span id="cb29-12"><a href="titanic.html#cb29-12" aria-hidden="true"></a>        <span class="st">&quot;Jonkheer&quot;</span></span>
<span id="cb29-13"><a href="titanic.html#cb29-13" aria-hidden="true"></a>    ],</span>
<span id="cb29-14"><a href="titanic.html#cb29-14" aria-hidden="true"></a>    <span class="st">&quot;Rare&quot;</span>,</span>
<span id="cb29-15"><a href="titanic.html#cb29-15" aria-hidden="true"></a>)</span>
<span id="cb29-16"><a href="titanic.html#cb29-16" aria-hidden="true"></a>repace_values_with(df, <span class="st">&quot;Title&quot;</span>, <span class="st">&quot;Mlle&quot;</span>, <span class="st">&quot;Miss&quot;</span>)</span>
<span id="cb29-17"><a href="titanic.html#cb29-17" aria-hidden="true"></a>repace_values_with(df, <span class="st">&quot;Title&quot;</span>, <span class="st">&quot;Ms&quot;</span>, <span class="st">&quot;Miss&quot;</span>)</span>
<span id="cb29-18"><a href="titanic.html#cb29-18" aria-hidden="true"></a>repace_values_with(df, <span class="st">&quot;Title&quot;</span>, <span class="st">&quot;Mme&quot;</span>, <span class="st">&quot;Mrs&quot;</span>)</span>
<span id="cb29-19"><a href="titanic.html#cb29-19" aria-hidden="true"></a></span>
<span id="cb29-20"><a href="titanic.html#cb29-20" aria-hidden="true"></a>df[[<span class="st">&quot;Title&quot;</span>, <span class="st">&quot;Survived&quot;</span>]].groupby([<span class="st">&quot;Title&quot;</span>], as_index<span class="op">=</span><span class="va">False</span>).mean()</span></code></pre></div>
<pre><code>##     Title  Survived
## 0    Dona       NaN
## 1  Master  0.575000
## 2    Miss  0.702703
## 3      Mr  0.156673
## 4     Mrs  0.793651
## 5    Rare  0.347826</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="titanic.html#cb31-1" aria-hidden="true"></a><span class="kw">def</span> cat_to_ord(df, FEATURE, DICT):</span>
<span id="cb31-2"><a href="titanic.html#cb31-2" aria-hidden="true"></a>    df[FEATURE] <span class="op">=</span> df[FEATURE].<span class="bu">map</span>(DICT).fillna(<span class="dv">0</span>)</span>
<span id="cb31-3"><a href="titanic.html#cb31-3" aria-hidden="true"></a></span>
<span id="cb31-4"><a href="titanic.html#cb31-4" aria-hidden="true"></a></span>
<span id="cb31-5"><a href="titanic.html#cb31-5" aria-hidden="true"></a>cat_to_ord(df, <span class="st">&quot;Title&quot;</span>, {</span>
<span id="cb31-6"><a href="titanic.html#cb31-6" aria-hidden="true"></a>    <span class="st">&quot;Master&quot;</span>: <span class="dv">1</span>,</span>
<span id="cb31-7"><a href="titanic.html#cb31-7" aria-hidden="true"></a>    <span class="st">&quot;Miss&quot;</span>: <span class="dv">2</span>,</span>
<span id="cb31-8"><a href="titanic.html#cb31-8" aria-hidden="true"></a>    <span class="st">&quot;Mr&quot;</span>: <span class="dv">3</span>,</span>
<span id="cb31-9"><a href="titanic.html#cb31-9" aria-hidden="true"></a>    <span class="st">&quot;Mrs&quot;</span>: <span class="dv">4</span>,</span>
<span id="cb31-10"><a href="titanic.html#cb31-10" aria-hidden="true"></a>    <span class="st">&quot;Rare&quot;</span>: <span class="dv">5</span>,</span>
<span id="cb31-11"><a href="titanic.html#cb31-11" aria-hidden="true"></a>})</span>
<span id="cb31-12"><a href="titanic.html#cb31-12" aria-hidden="true"></a></span>
<span id="cb31-13"><a href="titanic.html#cb31-13" aria-hidden="true"></a>df.drop([<span class="st">&quot;Name&quot;</span>], inplace<span class="op">=</span><span class="va">True</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb31-14"><a href="titanic.html#cb31-14" aria-hidden="true"></a></span>
<span id="cb31-15"><a href="titanic.html#cb31-15" aria-hidden="true"></a><span class="kw">def</span> dummify(df, features_list):</span>
<span id="cb31-16"><a href="titanic.html#cb31-16" aria-hidden="true"></a>    <span class="cf">return</span> pd.get_dummies(</span>
<span id="cb31-17"><a href="titanic.html#cb31-17" aria-hidden="true"></a>        df,</span>
<span id="cb31-18"><a href="titanic.html#cb31-18" aria-hidden="true"></a>        columns<span class="op">=</span>features_list,</span>
<span id="cb31-19"><a href="titanic.html#cb31-19" aria-hidden="true"></a>        drop_first<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb31-20"><a href="titanic.html#cb31-20" aria-hidden="true"></a>    )</span>
<span id="cb31-21"><a href="titanic.html#cb31-21" aria-hidden="true"></a></span>
<span id="cb31-22"><a href="titanic.html#cb31-22" aria-hidden="true"></a>df <span class="op">=</span> dummify(df, [<span class="st">&quot;Sex&quot;</span>])</span>
<span id="cb31-23"><a href="titanic.html#cb31-23" aria-hidden="true"></a></span>
<span id="cb31-24"><a href="titanic.html#cb31-24" aria-hidden="true"></a>g <span class="op">=</span> sns.FacetGrid(df, row<span class="op">=</span><span class="st">&quot;Pclass&quot;</span>, col<span class="op">=</span><span class="st">&quot;Sex_male&quot;</span>, size<span class="op">=</span><span class="fl">2.2</span>, aspect<span class="op">=</span><span class="fl">1.6</span>)</span></code></pre></div>
<pre><code>## /nix/store/lz8yaf1c80c6zb3qj11j58x3qq366wxx-python3.8-seaborn-0.11.0/lib/python3.8/site-packages/seaborn/axisgrid.py:316: UserWarning: The `size` parameter has been renamed to `height`; please update your code.
##   warnings.warn(msg, UserWarning)</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="titanic.html#cb33-1" aria-hidden="true"></a>g.<span class="bu">map</span>(plt.hist, <span class="st">&quot;Age&quot;</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, bins<span class="op">=</span><span class="dv">20</span>)</span></code></pre></div>
<pre><code>## &lt;seaborn.axisgrid.FacetGrid object at 0x7f268cd11d30&gt;</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="titanic.html#cb35-1" aria-hidden="true"></a>g.add_legend()</span></code></pre></div>
<pre><code>## &lt;seaborn.axisgrid.FacetGrid object at 0x7f268cd11d30&gt;</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="titanic.html#cb37-1" aria-hidden="true"></a>plt.savefig(<span class="st">&quot;06_hist_&quot;</span>)</span>
<span id="cb37-2"><a href="titanic.html#cb37-2" aria-hidden="true"></a>plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-15-1.png" width="686" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="titanic.html#cb38-1" aria-hidden="true"></a>guess_ages <span class="op">=</span> np.zeros((<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb38-2"><a href="titanic.html#cb38-2" aria-hidden="true"></a></span>
<span id="cb38-3"><a href="titanic.html#cb38-3" aria-hidden="true"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">2</span>):</span>
<span id="cb38-4"><a href="titanic.html#cb38-4" aria-hidden="true"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">3</span>):</span>
<span id="cb38-5"><a href="titanic.html#cb38-5" aria-hidden="true"></a>        guess_df <span class="op">=</span> df[(df[<span class="st">&quot;Sex_male&quot;</span>] <span class="op">==</span> i)</span>
<span id="cb38-6"><a href="titanic.html#cb38-6" aria-hidden="true"></a>                      <span class="op">&amp;</span> (df[<span class="st">&quot;Pclass&quot;</span>] <span class="op">==</span> j <span class="op">+</span> <span class="dv">1</span>)][<span class="st">&quot;Age&quot;</span>].dropna()</span>
<span id="cb38-7"><a href="titanic.html#cb38-7" aria-hidden="true"></a></span>
<span id="cb38-8"><a href="titanic.html#cb38-8" aria-hidden="true"></a>        <span class="co">## age_mean = guess_df.mean()</span></span>
<span id="cb38-9"><a href="titanic.html#cb38-9" aria-hidden="true"></a>        <span class="co"># age_std = guess_df.std()</span></span>
<span id="cb38-10"><a href="titanic.html#cb38-10" aria-hidden="true"></a>        <span class="co">## age_guess = rnd.uniform(age_mean - age_std, age_mean + age_std)</span></span>
<span id="cb38-11"><a href="titanic.html#cb38-11" aria-hidden="true"></a></span>
<span id="cb38-12"><a href="titanic.html#cb38-12" aria-hidden="true"></a>        age_guess <span class="op">=</span> guess_df.median()</span>
<span id="cb38-13"><a href="titanic.html#cb38-13" aria-hidden="true"></a></span>
<span id="cb38-14"><a href="titanic.html#cb38-14" aria-hidden="true"></a>        <span class="co">## Convert random age float to nearest .5 age</span></span>
<span id="cb38-15"><a href="titanic.html#cb38-15" aria-hidden="true"></a>        guess_ages[i, j] <span class="op">=</span> <span class="bu">int</span>(age_guess <span class="op">/</span> <span class="fl">0.5</span> <span class="op">+</span> <span class="fl">0.5</span>) <span class="op">*</span> <span class="fl">0.5</span></span>
<span id="cb38-16"><a href="titanic.html#cb38-16" aria-hidden="true"></a></span>
<span id="cb38-17"><a href="titanic.html#cb38-17" aria-hidden="true"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">2</span>):</span>
<span id="cb38-18"><a href="titanic.html#cb38-18" aria-hidden="true"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">3</span>):</span>
<span id="cb38-19"><a href="titanic.html#cb38-19" aria-hidden="true"></a>        df.loc[(df.Age.isnull()) <span class="op">&amp;</span> (df.Sex_male <span class="op">==</span> i) <span class="op">&amp;</span> (df.Pclass <span class="op">==</span> j <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb38-20"><a href="titanic.html#cb38-20" aria-hidden="true"></a>               <span class="st">&quot;Age&quot;</span>, ] <span class="op">=</span> guess_ages[i, j]</span>
<span id="cb38-21"><a href="titanic.html#cb38-21" aria-hidden="true"></a></span>
<span id="cb38-22"><a href="titanic.html#cb38-22" aria-hidden="true"></a>df[<span class="st">&quot;Age&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;Age&quot;</span>].astype(<span class="bu">int</span>)</span>
<span id="cb38-23"><a href="titanic.html#cb38-23" aria-hidden="true"></a></span>
<span id="cb38-24"><a href="titanic.html#cb38-24" aria-hidden="true"></a>df.head()</span></code></pre></div>
<pre><code>##    Survived  Pclass  Age  SibSp  Parch     Fare Embarked  Title  Sex_male
## 0       0.0       3   22      1      0   7.2500        S    3.0         1
## 1       1.0       1   38      1      0  71.2833        C    4.0         0
## 2       1.0       3   26      0      0   7.9250        S    2.0         0
## 3       1.0       1   35      1      0  53.1000        S    4.0         0
## 4       0.0       3   35      0      0   8.0500        S    3.0         1</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="titanic.html#cb40-1" aria-hidden="true"></a>df[<span class="st">&quot;Age_Band&quot;</span>] <span class="op">=</span> pd.cut(df[<span class="st">&quot;Age&quot;</span>], <span class="dv">5</span>)</span>
<span id="cb40-2"><a href="titanic.html#cb40-2" aria-hidden="true"></a>df[[<span class="st">&quot;Age_Band&quot;</span>,</span>
<span id="cb40-3"><a href="titanic.html#cb40-3" aria-hidden="true"></a>    <span class="st">&quot;Survived&quot;</span>]].groupby([<span class="st">&quot;Age_Band&quot;</span>],</span>
<span id="cb40-4"><a href="titanic.html#cb40-4" aria-hidden="true"></a>                         as_index<span class="op">=</span><span class="va">False</span>).mean().sort_values(by<span class="op">=</span><span class="st">&quot;Age_Band&quot;</span>,</span>
<span id="cb40-5"><a href="titanic.html#cb40-5" aria-hidden="true"></a>                                                            ascending<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<pre><code>##         Age_Band  Survived
## 0  (-0.08, 16.0]  0.550000
## 1   (16.0, 32.0]  0.337374
## 2   (32.0, 48.0]  0.412037
## 3   (48.0, 64.0]  0.434783
## 4   (64.0, 80.0]  0.090909</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="titanic.html#cb42-1" aria-hidden="true"></a>DATA_FRAME <span class="op">=</span> df</span>
<span id="cb42-2"><a href="titanic.html#cb42-2" aria-hidden="true"></a>COL <span class="op">=</span> <span class="st">&quot;Age&quot;</span></span>
<span id="cb42-3"><a href="titanic.html#cb42-3" aria-hidden="true"></a></span>
<span id="cb42-4"><a href="titanic.html#cb42-4" aria-hidden="true"></a><span class="kw">def</span> function1(col_value):</span>
<span id="cb42-5"><a href="titanic.html#cb42-5" aria-hidden="true"></a>    <span class="cf">if</span> col_value <span class="op">&lt;=</span> <span class="dv">16</span>:</span>
<span id="cb42-6"><a href="titanic.html#cb42-6" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb42-7"><a href="titanic.html#cb42-7" aria-hidden="true"></a>    <span class="cf">elif</span> (col_value <span class="op">&gt;</span> <span class="dv">16</span>) <span class="op">&amp;</span> (col_value <span class="op">&lt;=</span> <span class="dv">32</span>):</span>
<span id="cb42-8"><a href="titanic.html#cb42-8" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb42-9"><a href="titanic.html#cb42-9" aria-hidden="true"></a>    <span class="cf">elif</span> (col_value <span class="op">&gt;</span> <span class="dv">32</span>) <span class="op">&amp;</span> (col_value <span class="op">&lt;=</span> <span class="dv">48</span>):</span>
<span id="cb42-10"><a href="titanic.html#cb42-10" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">2</span></span>
<span id="cb42-11"><a href="titanic.html#cb42-11" aria-hidden="true"></a>    <span class="cf">elif</span> (col_value <span class="op">&gt;</span> <span class="dv">48</span>) <span class="op">&amp;</span> (col_value <span class="op">&lt;=</span> <span class="dv">64</span>):</span>
<span id="cb42-12"><a href="titanic.html#cb42-12" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">3</span></span>
<span id="cb42-13"><a href="titanic.html#cb42-13" aria-hidden="true"></a>    <span class="cf">else</span>:</span>
<span id="cb42-14"><a href="titanic.html#cb42-14" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">4</span></span>
<span id="cb42-15"><a href="titanic.html#cb42-15" aria-hidden="true"></a></span>
<span id="cb42-16"><a href="titanic.html#cb42-16" aria-hidden="true"></a>df[<span class="st">&quot;Age_Bands&quot;</span>] <span class="op">=</span> DATA_FRAME[COL].<span class="bu">apply</span>(<span class="kw">lambda</span> col_value: function1(col_value))</span>
<span id="cb42-17"><a href="titanic.html#cb42-17" aria-hidden="true"></a></span>
<span id="cb42-18"><a href="titanic.html#cb42-18" aria-hidden="true"></a>df[<span class="st">&quot;Family_size&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;SibSp&quot;</span>] <span class="op">+</span> df[<span class="st">&quot;Parch&quot;</span>] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb42-19"><a href="titanic.html#cb42-19" aria-hidden="true"></a></span>
<span id="cb42-20"><a href="titanic.html#cb42-20" aria-hidden="true"></a>df[[<span class="st">&quot;Family_size&quot;</span>,</span>
<span id="cb42-21"><a href="titanic.html#cb42-21" aria-hidden="true"></a>    <span class="st">&quot;Survived&quot;</span>]].groupby([<span class="st">&quot;Family_size&quot;</span>],</span>
<span id="cb42-22"><a href="titanic.html#cb42-22" aria-hidden="true"></a>                         as_index<span class="op">=</span><span class="va">False</span>).mean().sort_values(by<span class="op">=</span><span class="st">&quot;Survived&quot;</span>,</span>
<span id="cb42-23"><a href="titanic.html#cb42-23" aria-hidden="true"></a>                                                            ascending<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<pre><code>##    Family_size  Survived
## 3            4  0.724138
## 2            3  0.578431
## 1            2  0.552795
## 6            7  0.333333
## 0            1  0.303538
## 4            5  0.200000
## 5            6  0.136364
## 7            8  0.000000
## 8           11  0.000000</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="titanic.html#cb44-1" aria-hidden="true"></a>DATA_FRAME <span class="op">=</span> df</span>
<span id="cb44-2"><a href="titanic.html#cb44-2" aria-hidden="true"></a>COL <span class="op">=</span> <span class="st">&quot;Family_size&quot;</span></span>
<span id="cb44-3"><a href="titanic.html#cb44-3" aria-hidden="true"></a></span>
<span id="cb44-4"><a href="titanic.html#cb44-4" aria-hidden="true"></a><span class="kw">def</span> function1(col_value):</span>
<span id="cb44-5"><a href="titanic.html#cb44-5" aria-hidden="true"></a>    <span class="cf">if</span> col_value <span class="op">&gt;=</span> <span class="dv">2</span>:</span>
<span id="cb44-6"><a href="titanic.html#cb44-6" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb44-7"><a href="titanic.html#cb44-7" aria-hidden="true"></a>    <span class="cf">else</span>:</span>
<span id="cb44-8"><a href="titanic.html#cb44-8" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb44-9"><a href="titanic.html#cb44-9" aria-hidden="true"></a></span>
<span id="cb44-10"><a href="titanic.html#cb44-10" aria-hidden="true"></a>df[<span class="st">&quot;Is_alone&quot;</span>] <span class="op">=</span> DATA_FRAME[COL].<span class="bu">apply</span>(<span class="kw">lambda</span> col_value: function1(col_value))</span>
<span id="cb44-11"><a href="titanic.html#cb44-11" aria-hidden="true"></a></span>
<span id="cb44-12"><a href="titanic.html#cb44-12" aria-hidden="true"></a>df[[<span class="st">&quot;Is_alone&quot;</span>,</span>
<span id="cb44-13"><a href="titanic.html#cb44-13" aria-hidden="true"></a>    <span class="st">&quot;Survived&quot;</span>]].groupby([<span class="st">&quot;Is_alone&quot;</span>]).mean().sort_values(by<span class="op">=</span><span class="st">&quot;Survived&quot;</span>)</span></code></pre></div>
<pre><code>##           Survived
## Is_alone          
## 1         0.303538
## 0         0.505650</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="titanic.html#cb46-1" aria-hidden="true"></a>df[<span class="st">&quot;Embarked&quot;</span>].fillna(<span class="st">&quot;S&quot;</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-2"><a href="titanic.html#cb46-2" aria-hidden="true"></a></span>
<span id="cb46-3"><a href="titanic.html#cb46-3" aria-hidden="true"></a>df[<span class="st">&quot;Embarked&quot;</span>] <span class="op">=</span> df[<span class="st">&quot;Embarked&quot;</span>].<span class="bu">map</span>({<span class="st">&quot;S&quot;</span>: <span class="dv">0</span>, <span class="st">&quot;C&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;Q&quot;</span>: <span class="dv">2</span>}).astype(<span class="bu">int</span>)</span>
<span id="cb46-4"><a href="titanic.html#cb46-4" aria-hidden="true"></a></span>
<span id="cb46-5"><a href="titanic.html#cb46-5" aria-hidden="true"></a><span class="bu">print</span>(pd.qcut(df[<span class="st">&quot;Fare&quot;</span>], <span class="dv">4</span>)[[]])</span></code></pre></div>
<pre><code>## Series([], Name: Fare, dtype: category
## Categories (4, interval[float64]): [(-0.001, 7.896] &lt; (7.896, 14.454] &lt; (14.454, 31.275] &lt;
##                                     (31.275, 512.329]])</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="titanic.html#cb48-1" aria-hidden="true"></a>DATA_FRAME <span class="op">=</span> df</span>
<span id="cb48-2"><a href="titanic.html#cb48-2" aria-hidden="true"></a>COL <span class="op">=</span> <span class="st">&quot;Fare&quot;</span></span>
<span id="cb48-3"><a href="titanic.html#cb48-3" aria-hidden="true"></a></span>
<span id="cb48-4"><a href="titanic.html#cb48-4" aria-hidden="true"></a><span class="kw">def</span> function1(col_value):</span>
<span id="cb48-5"><a href="titanic.html#cb48-5" aria-hidden="true"></a>    <span class="cf">if</span> col_value <span class="op">&lt;=</span> <span class="fl">7.91</span>:</span>
<span id="cb48-6"><a href="titanic.html#cb48-6" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb48-7"><a href="titanic.html#cb48-7" aria-hidden="true"></a>    <span class="cf">elif</span> (col_value <span class="op">&gt;=</span> <span class="fl">7.91</span>) <span class="op">&amp;</span> (col_value <span class="op">&lt;=</span> <span class="fl">14.454</span>):</span>
<span id="cb48-8"><a href="titanic.html#cb48-8" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb48-9"><a href="titanic.html#cb48-9" aria-hidden="true"></a>    <span class="cf">elif</span> (col_value <span class="op">&gt;=</span> <span class="fl">14.454</span>) <span class="op">&amp;</span> (col_value <span class="op">&lt;=</span> <span class="fl">31.0</span>):</span>
<span id="cb48-10"><a href="titanic.html#cb48-10" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">2</span></span>
<span id="cb48-11"><a href="titanic.html#cb48-11" aria-hidden="true"></a>    <span class="cf">else</span>:</span>
<span id="cb48-12"><a href="titanic.html#cb48-12" aria-hidden="true"></a>        <span class="cf">return</span> <span class="dv">3</span></span>
<span id="cb48-13"><a href="titanic.html#cb48-13" aria-hidden="true"></a></span>
<span id="cb48-14"><a href="titanic.html#cb48-14" aria-hidden="true"></a>df[<span class="st">&quot;Fare_bands&quot;</span>] <span class="op">=</span> DATA_FRAME[COL].<span class="bu">apply</span>(</span>
<span id="cb48-15"><a href="titanic.html#cb48-15" aria-hidden="true"></a>    <span class="kw">lambda</span> col_value: function1(col_value))</span>
<span id="cb48-16"><a href="titanic.html#cb48-16" aria-hidden="true"></a></span>
<span id="cb48-17"><a href="titanic.html#cb48-17" aria-hidden="true"></a>df.drop([<span class="st">&quot;SibSp&quot;</span>, <span class="st">&quot;Parch&quot;</span>, <span class="st">&quot;Age_Band&quot;</span>, <span class="st">&quot;Is_alone&quot;</span>, <span class="st">&quot;Fare&quot;</span>, <span class="st">&quot;Age&quot;</span>],</span>
<span id="cb48-18"><a href="titanic.html#cb48-18" aria-hidden="true"></a>        inplace<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb48-19"><a href="titanic.html#cb48-19" aria-hidden="true"></a>        axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb48-20"><a href="titanic.html#cb48-20" aria-hidden="true"></a></span>
<span id="cb48-21"><a href="titanic.html#cb48-21" aria-hidden="true"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">12</span>))</span>
<span id="cb48-22"><a href="titanic.html#cb48-22" aria-hidden="true"></a>plt.title(<span class="st">&#39;Correlation of Features&#39;</span>, y<span class="op">=</span><span class="fl">1.05</span>, size<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb48-23"><a href="titanic.html#cb48-23" aria-hidden="true"></a>mask <span class="op">=</span> np.zeros_like(df.corr())</span>
<span id="cb48-24"><a href="titanic.html#cb48-24" aria-hidden="true"></a>mask[np.triu_indices_from(mask)] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb48-25"><a href="titanic.html#cb48-25" aria-hidden="true"></a>sns.heatmap(</span>
<span id="cb48-26"><a href="titanic.html#cb48-26" aria-hidden="true"></a>    df.astype(<span class="bu">float</span>).corr(),</span>
<span id="cb48-27"><a href="titanic.html#cb48-27" aria-hidden="true"></a>    annot<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb48-28"><a href="titanic.html#cb48-28" aria-hidden="true"></a>    linewidths<span class="op">=</span><span class="fl">0.2</span>,</span>
<span id="cb48-29"><a href="titanic.html#cb48-29" aria-hidden="true"></a>    linecolor<span class="op">=</span><span class="st">&#39;white&#39;</span>,</span>
<span id="cb48-30"><a href="titanic.html#cb48-30" aria-hidden="true"></a>    cmap<span class="op">=</span><span class="st">&quot;RdBu&quot;</span>,</span>
<span id="cb48-31"><a href="titanic.html#cb48-31" aria-hidden="true"></a>    center<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb48-32"><a href="titanic.html#cb48-32" aria-hidden="true"></a>    mask<span class="op">=</span>mask,</span>
<span id="cb48-33"><a href="titanic.html#cb48-33" aria-hidden="true"></a>    vmax<span class="op">=</span><span class="fl">1.0</span>,</span>
<span id="cb48-34"><a href="titanic.html#cb48-34" aria-hidden="true"></a>    vmin<span class="op">=-</span><span class="fl">1.0</span>,</span>
<span id="cb48-35"><a href="titanic.html#cb48-35" aria-hidden="true"></a>    square<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb48-36"><a href="titanic.html#cb48-36" aria-hidden="true"></a>)</span>
<span id="cb48-37"><a href="titanic.html#cb48-37" aria-hidden="true"></a>plt.savefig(<span class="st">&quot;03_correlation_map_2&quot;</span>)</span>
<span id="cb48-38"><a href="titanic.html#cb48-38" aria-hidden="true"></a>plt.show()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-15-2.png" width="1344" /></p>
</div>
</div>
<div id="models" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Models</h2>
<div id="prepartion" class="section level3" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Prepartion</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="titanic.html#cb49-1" aria-hidden="true"></a>TARGET_COL <span class="op">=</span> <span class="st">&quot;Survived&quot;</span></span>
<span id="cb49-2"><a href="titanic.html#cb49-2" aria-hidden="true"></a>df <span class="op">=</span> df[<span class="op">~</span>df[TARGET_COL].isna()]  <span class="co">## ~ = not</span></span>
<span id="cb49-3"><a href="titanic.html#cb49-3" aria-hidden="true"></a></span>
<span id="cb49-4"><a href="titanic.html#cb49-4" aria-hidden="true"></a><span class="co">## df = df.sample(frac=0.2,random_state=101)</span></span>
<span id="cb49-5"><a href="titanic.html#cb49-5" aria-hidden="true"></a>feat <span class="op">=</span> df.drop(TARGET_COL, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb49-6"><a href="titanic.html#cb49-6" aria-hidden="true"></a>tar <span class="op">=</span> df[TARGET_COL]</span>
<span id="cb49-7"><a href="titanic.html#cb49-7" aria-hidden="true"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb49-8"><a href="titanic.html#cb49-8" aria-hidden="true"></a></span>
<span id="cb49-9"><a href="titanic.html#cb49-9" aria-hidden="true"></a>feat_train, feat_test, tar_train, tar_test <span class="op">=</span> train_test_split(feat, tar, test_size<span class="op">=</span><span class="fl">0.3</span>)</span></code></pre></div>
</div>
<div id="run-models" class="section level3" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Run Models</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="titanic.html#cb50-1" aria-hidden="true"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb50-2"><a href="titanic.html#cb50-2" aria-hidden="true"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression, Perceptron, SGDClassifier</span>
<span id="cb50-3"><a href="titanic.html#cb50-3" aria-hidden="true"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb50-4"><a href="titanic.html#cb50-4" aria-hidden="true"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb50-5"><a href="titanic.html#cb50-5" aria-hidden="true"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC, LinearSVC</span>
<span id="cb50-6"><a href="titanic.html#cb50-6" aria-hidden="true"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb50-7"><a href="titanic.html#cb50-7" aria-hidden="true"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb50-8"><a href="titanic.html#cb50-8" aria-hidden="true"></a></span>
<span id="cb50-9"><a href="titanic.html#cb50-9" aria-hidden="true"></a><span class="kw">def</span> knn_value_plot(feat_train, tar_train, feat_test, tar_test, max_range):</span>
<span id="cb50-10"><a href="titanic.html#cb50-10" aria-hidden="true"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb50-11"><a href="titanic.html#cb50-11" aria-hidden="true"></a><span class="co">    Iterate to get the best k value and plot it,</span></span>
<span id="cb50-12"><a href="titanic.html#cb50-12" aria-hidden="true"></a><span class="co">    between 1 and the max_range</span></span>
<span id="cb50-13"><a href="titanic.html#cb50-13" aria-hidden="true"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb50-14"><a href="titanic.html#cb50-14" aria-hidden="true"></a>    error_rate <span class="op">=</span> []</span>
<span id="cb50-15"><a href="titanic.html#cb50-15" aria-hidden="true"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, max_range):</span>
<span id="cb50-16"><a href="titanic.html#cb50-16" aria-hidden="true"></a>        model_knn <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span>i)</span>
<span id="cb50-17"><a href="titanic.html#cb50-17" aria-hidden="true"></a>        model_knn.fit(feat_train, tar_train)</span>
<span id="cb50-18"><a href="titanic.html#cb50-18" aria-hidden="true"></a>        pred_knn <span class="op">=</span> model_knn.predict(feat_test)</span>
<span id="cb50-19"><a href="titanic.html#cb50-19" aria-hidden="true"></a>        error_rate.append(np.mean(pred_knn <span class="op">!=</span> tar_test))</span>
<span id="cb50-20"><a href="titanic.html#cb50-20" aria-hidden="true"></a>    plt.clf()</span>
<span id="cb50-21"><a href="titanic.html#cb50-21" aria-hidden="true"></a>    sns.lineplot(x<span class="op">=</span><span class="bu">range</span>(<span class="dv">1</span>, max_range), y<span class="op">=</span>error_rate)</span>
<span id="cb50-22"><a href="titanic.html#cb50-22" aria-hidden="true"></a>    plt.savefig(<span class="st">&quot;model_knn_n_values&quot;</span>)</span>
<span id="cb50-23"><a href="titanic.html#cb50-23" aria-hidden="true"></a></span>
<span id="cb50-24"><a href="titanic.html#cb50-24" aria-hidden="true"></a></span>
<span id="cb50-25"><a href="titanic.html#cb50-25" aria-hidden="true"></a><span class="co"># knn_value_plot(feat_train, tar_train, feat_test, tar_test, 30)</span></span>
<span id="cb50-26"><a href="titanic.html#cb50-26" aria-hidden="true"></a></span>
<span id="cb50-27"><a href="titanic.html#cb50-27" aria-hidden="true"></a><span class="co">#</span></span>
<span id="cb50-28"><a href="titanic.html#cb50-28" aria-hidden="true"></a></span>
<span id="cb50-29"><a href="titanic.html#cb50-29" aria-hidden="true"></a>knn_n_value <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb50-30"><a href="titanic.html#cb50-30" aria-hidden="true"></a><span class="kw">def</span> basic_models(feat_train, tar_train, feat_test, tar_test, knn_neighbours):</span>
<span id="cb50-31"><a href="titanic.html#cb50-31" aria-hidden="true"></a>    <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb50-32"><a href="titanic.html#cb50-32" aria-hidden="true"></a><span class="co">    A set of all the basic models to be easily applied,</span></span>
<span id="cb50-33"><a href="titanic.html#cb50-33" aria-hidden="true"></a><span class="co">    Returns the logistic correlation, and the % score of each model</span></span>
<span id="cb50-34"><a href="titanic.html#cb50-34" aria-hidden="true"></a><span class="co">    Also globally exports the predications of each model as ex. pred_logreg</span></span>
<span id="cb50-35"><a href="titanic.html#cb50-35" aria-hidden="true"></a><span class="co">    &quot;&quot;&quot;</span></span>
<span id="cb50-36"><a href="titanic.html#cb50-36" aria-hidden="true"></a>    <span class="co"># Imports</span></span>
<span id="cb50-37"><a href="titanic.html#cb50-37" aria-hidden="true"></a>    <span class="co"># Values to be exported</span></span>
<span id="cb50-38"><a href="titanic.html#cb50-38" aria-hidden="true"></a>    <span class="kw">global</span> pred_rfc</span>
<span id="cb50-39"><a href="titanic.html#cb50-39" aria-hidden="true"></a>    <span class="kw">global</span> pred_logreg</span>
<span id="cb50-40"><a href="titanic.html#cb50-40" aria-hidden="true"></a>    <span class="kw">global</span> pred_svc</span>
<span id="cb50-41"><a href="titanic.html#cb50-41" aria-hidden="true"></a>    <span class="kw">global</span> pred_rfc</span>
<span id="cb50-42"><a href="titanic.html#cb50-42" aria-hidden="true"></a>    <span class="kw">global</span> pred_gaus</span>
<span id="cb50-43"><a href="titanic.html#cb50-43" aria-hidden="true"></a>    <span class="kw">global</span> pred_perc</span>
<span id="cb50-44"><a href="titanic.html#cb50-44" aria-hidden="true"></a>    <span class="kw">global</span> pred_sgd</span>
<span id="cb50-45"><a href="titanic.html#cb50-45" aria-hidden="true"></a>    <span class="kw">global</span> pred_linear_svc</span>
<span id="cb50-46"><a href="titanic.html#cb50-46" aria-hidden="true"></a>    <span class="kw">global</span> pred_dtree</span>
<span id="cb50-47"><a href="titanic.html#cb50-47" aria-hidden="true"></a>    <span class="kw">global</span> pred_knn</span>
<span id="cb50-48"><a href="titanic.html#cb50-48" aria-hidden="true"></a>    <span class="kw">global</span> pred_xgb</span>
<span id="cb50-49"><a href="titanic.html#cb50-49" aria-hidden="true"></a>    <span class="co"># LogisticRegression</span></span>
<span id="cb50-50"><a href="titanic.html#cb50-50" aria-hidden="true"></a>    model_logreg <span class="op">=</span> LogisticRegression().fit(feat_train, tar_train)</span>
<span id="cb50-51"><a href="titanic.html#cb50-51" aria-hidden="true"></a>    pred_logreg <span class="op">=</span> model_logreg.predict(feat_test)</span>
<span id="cb50-52"><a href="titanic.html#cb50-52" aria-hidden="true"></a>    <span class="co"># knn</span></span>
<span id="cb50-53"><a href="titanic.html#cb50-53" aria-hidden="true"></a>    model_knn <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span>knn_neighbours).fit(</span>
<span id="cb50-54"><a href="titanic.html#cb50-54" aria-hidden="true"></a>        feat_train, tar_train)</span>
<span id="cb50-55"><a href="titanic.html#cb50-55" aria-hidden="true"></a>    pred_knn <span class="op">=</span> model_knn.predict(feat_test)</span>
<span id="cb50-56"><a href="titanic.html#cb50-56" aria-hidden="true"></a>    <span class="co"># SVM</span></span>
<span id="cb50-57"><a href="titanic.html#cb50-57" aria-hidden="true"></a>    model_svc <span class="op">=</span> SVC().fit(feat_train, tar_train)</span>
<span id="cb50-58"><a href="titanic.html#cb50-58" aria-hidden="true"></a>    pred_svc <span class="op">=</span> model_svc.predict(feat_test)</span>
<span id="cb50-59"><a href="titanic.html#cb50-59" aria-hidden="true"></a>    <span class="co"># GaussianNB</span></span>
<span id="cb50-60"><a href="titanic.html#cb50-60" aria-hidden="true"></a>    model_gaus <span class="op">=</span> GaussianNB().fit(feat_train, tar_train)</span>
<span id="cb50-61"><a href="titanic.html#cb50-61" aria-hidden="true"></a>    pred_gaus <span class="op">=</span> model_gaus.predict(feat_test)</span>
<span id="cb50-62"><a href="titanic.html#cb50-62" aria-hidden="true"></a>    <span class="co"># Perceptron</span></span>
<span id="cb50-63"><a href="titanic.html#cb50-63" aria-hidden="true"></a>    model_perc <span class="op">=</span> Perceptron().fit(feat_train, tar_train)</span>
<span id="cb50-64"><a href="titanic.html#cb50-64" aria-hidden="true"></a>    pred_perc <span class="op">=</span> model_perc.predict(feat_test)</span>
<span id="cb50-65"><a href="titanic.html#cb50-65" aria-hidden="true"></a>    <span class="co"># LinearSVC</span></span>
<span id="cb50-66"><a href="titanic.html#cb50-66" aria-hidden="true"></a>    model_linear_svc <span class="op">=</span> LinearSVC().fit(feat_train, tar_train)</span>
<span id="cb50-67"><a href="titanic.html#cb50-67" aria-hidden="true"></a>    pred_linear_svc <span class="op">=</span> model_perc.predict(feat_test)</span>
<span id="cb50-68"><a href="titanic.html#cb50-68" aria-hidden="true"></a>    <span class="co"># Stochastic Gradient Descent</span></span>
<span id="cb50-69"><a href="titanic.html#cb50-69" aria-hidden="true"></a>    model_sgd <span class="op">=</span> SGDClassifier().fit(feat_train, tar_train)</span>
<span id="cb50-70"><a href="titanic.html#cb50-70" aria-hidden="true"></a>    pred_sgd <span class="op">=</span> model_perc.predict(feat_test)</span>
<span id="cb50-71"><a href="titanic.html#cb50-71" aria-hidden="true"></a>    <span class="co"># DecisionTreeClassifier</span></span>
<span id="cb50-72"><a href="titanic.html#cb50-72" aria-hidden="true"></a>    model_dtree <span class="op">=</span> DecisionTreeClassifier().fit(feat_train, tar_train)</span>
<span id="cb50-73"><a href="titanic.html#cb50-73" aria-hidden="true"></a>    pred_dtree <span class="op">=</span> model_dtree.predict(feat_test)</span>
<span id="cb50-74"><a href="titanic.html#cb50-74" aria-hidden="true"></a>    <span class="co"># RandomForestClassifier</span></span>
<span id="cb50-75"><a href="titanic.html#cb50-75" aria-hidden="true"></a>    model_rfc <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">200</span>).fit(feat_train, tar_train)</span>
<span id="cb50-76"><a href="titanic.html#cb50-76" aria-hidden="true"></a>    pred_rfc <span class="op">=</span> model_rfc.predict(feat_test)</span>
<span id="cb50-77"><a href="titanic.html#cb50-77" aria-hidden="true"></a>    <span class="co"># </span></span>
<span id="cb50-78"><a href="titanic.html#cb50-78" aria-hidden="true"></a>    model_xgb <span class="op">=</span> xgb.XGBClassifier().fit(feat_train, tar_train)</span>
<span id="cb50-79"><a href="titanic.html#cb50-79" aria-hidden="true"></a>    pred_xgb <span class="op">=</span> model_xgb.predict(feat_test)</span>
<span id="cb50-80"><a href="titanic.html#cb50-80" aria-hidden="true"></a>    <span class="co">#  LogisticRegression Correlations</span></span>
<span id="cb50-81"><a href="titanic.html#cb50-81" aria-hidden="true"></a>    coeff_df <span class="op">=</span> pd.DataFrame(feat_train.columns)</span>
<span id="cb50-82"><a href="titanic.html#cb50-82" aria-hidden="true"></a>    coeff_df.columns <span class="op">=</span> [<span class="st">&quot;Feature&quot;</span>]</span>
<span id="cb50-83"><a href="titanic.html#cb50-83" aria-hidden="true"></a>    coeff_df[<span class="st">&quot;Correlation&quot;</span>] <span class="op">=</span> pd.Series(model_logreg.coef_[<span class="dv">0</span>])</span>
<span id="cb50-84"><a href="titanic.html#cb50-84" aria-hidden="true"></a>    coeff_df <span class="op">=</span> coeff_df.sort_values(by<span class="op">=</span><span class="st">&quot;Correlation&quot;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb50-85"><a href="titanic.html#cb50-85" aria-hidden="true"></a>    <span class="co"># Result score</span></span>
<span id="cb50-86"><a href="titanic.html#cb50-86" aria-hidden="true"></a>    models <span class="op">=</span> pd.DataFrame({</span>
<span id="cb50-87"><a href="titanic.html#cb50-87" aria-hidden="true"></a>        <span class="st">&quot;Model&quot;</span>: [</span>
<span id="cb50-88"><a href="titanic.html#cb50-88" aria-hidden="true"></a>            <span class="st">&quot;Logistic Regression&quot;</span>,</span>
<span id="cb50-89"><a href="titanic.html#cb50-89" aria-hidden="true"></a>            <span class="st">&quot;Support Vector Machines&quot;</span>,</span>
<span id="cb50-90"><a href="titanic.html#cb50-90" aria-hidden="true"></a>            <span class="st">&quot;Random Forest&quot;</span>,</span>
<span id="cb50-91"><a href="titanic.html#cb50-91" aria-hidden="true"></a>            <span class="st">&quot;Naive Bayes&quot;</span>,</span>
<span id="cb50-92"><a href="titanic.html#cb50-92" aria-hidden="true"></a>            <span class="st">&quot;Perceptron&quot;</span>,</span>
<span id="cb50-93"><a href="titanic.html#cb50-93" aria-hidden="true"></a>            <span class="st">&quot;Stochastic Gradient Decent&quot;</span>,</span>
<span id="cb50-94"><a href="titanic.html#cb50-94" aria-hidden="true"></a>            <span class="st">&quot;Linear SVC&quot;</span>,</span>
<span id="cb50-95"><a href="titanic.html#cb50-95" aria-hidden="true"></a>            <span class="st">&quot;Decision Tree&quot;</span>,</span>
<span id="cb50-96"><a href="titanic.html#cb50-96" aria-hidden="true"></a>            <span class="st">&quot;KNN&quot;</span>,</span>
<span id="cb50-97"><a href="titanic.html#cb50-97" aria-hidden="true"></a>            <span class="st">&quot;Xgboost&quot;</span></span>
<span id="cb50-98"><a href="titanic.html#cb50-98" aria-hidden="true"></a>        ],</span>
<span id="cb50-99"><a href="titanic.html#cb50-99" aria-hidden="true"></a>        <span class="st">&quot;Score&quot;</span>: [</span>
<span id="cb50-100"><a href="titanic.html#cb50-100" aria-hidden="true"></a>            <span class="bu">round</span>(model_logreg.score(feat_test,     tar_test) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb50-101"><a href="titanic.html#cb50-101" aria-hidden="true"></a>            <span class="bu">round</span>(model_svc.score(feat_test,        tar_test) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb50-102"><a href="titanic.html#cb50-102" aria-hidden="true"></a>            <span class="bu">round</span>(model_rfc.score(feat_test,        tar_test) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb50-103"><a href="titanic.html#cb50-103" aria-hidden="true"></a>            <span class="bu">round</span>(model_gaus.score(feat_test,       tar_test) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb50-104"><a href="titanic.html#cb50-104" aria-hidden="true"></a>            <span class="bu">round</span>(model_perc.score(feat_test,       tar_test) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb50-105"><a href="titanic.html#cb50-105" aria-hidden="true"></a>            <span class="bu">round</span>(model_sgd.score(feat_test,        tar_test) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb50-106"><a href="titanic.html#cb50-106" aria-hidden="true"></a>            <span class="bu">round</span>(model_linear_svc.score(feat_test, tar_test) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb50-107"><a href="titanic.html#cb50-107" aria-hidden="true"></a>            <span class="bu">round</span>(model_dtree.score(feat_test,      tar_test) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb50-108"><a href="titanic.html#cb50-108" aria-hidden="true"></a>            <span class="bu">round</span>(model_knn.score(feat_test,        tar_test) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb50-109"><a href="titanic.html#cb50-109" aria-hidden="true"></a>            <span class="bu">round</span>(model_xgb.score(feat_test,        tar_test) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb50-110"><a href="titanic.html#cb50-110" aria-hidden="true"></a>        ],</span>
<span id="cb50-111"><a href="titanic.html#cb50-111" aria-hidden="true"></a>    }).sort_values(by<span class="op">=</span><span class="st">&quot;Score&quot;</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb50-112"><a href="titanic.html#cb50-112" aria-hidden="true"></a>    <span class="cf">return</span> (coeff_df, <span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n\n</span><span class="st">&quot;</span>), models)</span>
<span id="cb50-113"><a href="titanic.html#cb50-113" aria-hidden="true"></a></span>
<span id="cb50-114"><a href="titanic.html#cb50-114" aria-hidden="true"></a></span>
<span id="cb50-115"><a href="titanic.html#cb50-115" aria-hidden="true"></a>basic_models(feat_train, tar_train, feat_test, tar_test, knn_n_value)</span>
<span id="cb50-116"><a href="titanic.html#cb50-116" aria-hidden="true"></a></span>
<span id="cb50-117"><a href="titanic.html#cb50-117" aria-hidden="true"></a><span class="co">## ##</span></span>
<span id="cb50-118"><a href="titanic.html#cb50-118" aria-hidden="true"></a><span class="co"># import xgboost as xgb</span></span>
<span id="cb50-119"><a href="titanic.html#cb50-119" aria-hidden="true"></a><span class="co"># ## @knitr model_xgboost</span></span>
<span id="cb50-120"><a href="titanic.html#cb50-120" aria-hidden="true"></a></span>
<span id="cb50-121"><a href="titanic.html#cb50-121" aria-hidden="true"></a><span class="co"># RANGE = np.arange(.5, 1.5, .1)</span></span>
<span id="cb50-122"><a href="titanic.html#cb50-122" aria-hidden="true"></a><span class="co"># error_rate = []</span></span>
<span id="cb50-123"><a href="titanic.html#cb50-123" aria-hidden="true"></a><span class="co"># for i in RANGE:</span></span>
<span id="cb50-124"><a href="titanic.html#cb50-124" aria-hidden="true"></a>    <span class="co"># model_xgb = xgb.XGBClassifier(</span></span>
<span id="cb50-125"><a href="titanic.html#cb50-125" aria-hidden="true"></a>            <span class="co"># learning_rate = 0.5,</span></span>
<span id="cb50-126"><a href="titanic.html#cb50-126" aria-hidden="true"></a>            <span class="co"># # n_estimators= 2000,</span></span>
<span id="cb50-127"><a href="titanic.html#cb50-127" aria-hidden="true"></a>            <span class="co"># # max_depth= i,</span></span>
<span id="cb50-128"><a href="titanic.html#cb50-128" aria-hidden="true"></a>            <span class="co"># # min_child_weight= 2,</span></span>
<span id="cb50-129"><a href="titanic.html#cb50-129" aria-hidden="true"></a>            <span class="co"># gamma= .77, #gamma=1,</span></span>
<span id="cb50-130"><a href="titanic.html#cb50-130" aria-hidden="true"></a>            <span class="co"># subsample=.5,</span></span>
<span id="cb50-131"><a href="titanic.html#cb50-131" aria-hidden="true"></a>            <span class="co"># colsample_bytree=1,</span></span>
<span id="cb50-132"><a href="titanic.html#cb50-132" aria-hidden="true"></a>            <span class="co"># # objective= &#39;binary:logistic&#39;,</span></span>
<span id="cb50-133"><a href="titanic.html#cb50-133" aria-hidden="true"></a>            <span class="co"># # nthread= -1,</span></span>
<span id="cb50-134"><a href="titanic.html#cb50-134" aria-hidden="true"></a>            <span class="co"># scale_pos_weight=i,</span></span>
<span id="cb50-135"><a href="titanic.html#cb50-135" aria-hidden="true"></a>            <span class="co"># ).fit(feat_train, tar_train)</span></span>
<span id="cb50-136"><a href="titanic.html#cb50-136" aria-hidden="true"></a>    <span class="co"># pred_xgb = model_xgb.predict(feat_test)</span></span>
<span id="cb50-137"><a href="titanic.html#cb50-137" aria-hidden="true"></a>    <span class="co"># # error_rate.append(round(model_xgb.score(feat_test, tar_test) * 100, 2))</span></span>
<span id="cb50-138"><a href="titanic.html#cb50-138" aria-hidden="true"></a>    <span class="co"># print(&#39;value: &#39;, round(i, 3), &#39;result: &#39;, round(model_xgb.score(feat_test, tar_test) * 100, 2))</span></span>
<span id="cb50-139"><a href="titanic.html#cb50-139" aria-hidden="true"></a></span>
<span id="cb50-140"><a href="titanic.html#cb50-140" aria-hidden="true"></a><span class="co"># sns.lineplot(x=RANGE, y=error_rate)</span></span>
<span id="cb50-141"><a href="titanic.html#cb50-141" aria-hidden="true"></a><span class="co"># plt.savefig(&quot;model_xgb_scale_pos&quot;)</span></span>
<span id="cb50-142"><a href="titanic.html#cb50-142" aria-hidden="true"></a><span class="co"># plt.cla()</span></span>
<span id="cb50-143"><a href="titanic.html#cb50-143" aria-hidden="true"></a><span class="co">##</span></span></code></pre></div>
<pre><code>## 
## 
## 
## (       Feature  Correlation
## 6   Fare_bands     0.293955
## 1     Embarked     0.179744
## 5  Family_size    -0.279801
## 2        Title    -0.330510
## 4    Age_Bands    -0.567774
## 0       Pclass    -1.075916
## 3     Sex_male    -2.692426, None,                         Model  Score
## 1     Support Vector Machines  81.72
## 9                     Xgboost  80.97
## 8                         KNN  79.85
## 2               Random Forest  79.48
## 7               Decision Tree  77.99
## 6                  Linear SVC  76.49
## 0         Logistic Regression  76.12
## 3                 Naive Bayes  75.37
## 4                  Perceptron  73.88
## 5  Stochastic Gradient Decent  69.78)
## 
## /nix/store/64ka5flvkgi6rw2xz1bxp28prrks09dg-python3.8-scikit-learn-0.23.2/lib/python3.8/site-packages/sklearn/svm/_base.py:976: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.
##   warnings.warn(&quot;Liblinear failed to converge, increase &quot;</code></pre>
</div>
<div id="xgboost-model" class="section level3" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Xgboost model</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="titanic.html#cb52-1" aria-hidden="true"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb52-2"><a href="titanic.html#cb52-2" aria-hidden="true"></a>model_xgb <span class="op">=</span> xgb.XGBClassifier(</span>
<span id="cb52-3"><a href="titanic.html#cb52-3" aria-hidden="true"></a>        ).fit(feat_train, tar_train)</span>
<span id="cb52-4"><a href="titanic.html#cb52-4" aria-hidden="true"></a>pred_xgb <span class="op">=</span> model_xgb.predict(feat_test)</span>
<span id="cb52-5"><a href="titanic.html#cb52-5" aria-hidden="true"></a></span>
<span id="cb52-6"><a href="titanic.html#cb52-6" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&#39;baseline&#39;</span>, <span class="bu">round</span>(model_xgb.score(feat_test, tar_test) <span class="op">*</span> <span class="dv">100</span>,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## baseline 80.97</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="titanic.html#cb54-1" aria-hidden="true"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb54-2"><a href="titanic.html#cb54-2" aria-hidden="true"></a>model_xgb <span class="op">=</span> xgb.XGBClassifier(</span>
<span id="cb54-3"><a href="titanic.html#cb54-3" aria-hidden="true"></a>        learning_rate <span class="op">=</span> <span class="fl">.5</span>,</span>
<span id="cb54-4"><a href="titanic.html#cb54-4" aria-hidden="true"></a>        gamma<span class="op">=</span><span class="fl">0.77</span>, <span class="co">#gamma=1,</span></span>
<span id="cb54-5"><a href="titanic.html#cb54-5" aria-hidden="true"></a>        subsample<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb54-6"><a href="titanic.html#cb54-6" aria-hidden="true"></a>        ).fit(feat_train, tar_train)</span>
<span id="cb54-7"><a href="titanic.html#cb54-7" aria-hidden="true"></a>pred_xgb <span class="op">=</span> model_xgb.predict(feat_test)</span>
<span id="cb54-8"><a href="titanic.html#cb54-8" aria-hidden="true"></a><span class="bu">print</span>(<span class="st">&#39;personal&#39;</span>, <span class="bu">round</span>(model_xgb.score(feat_test, tar_test) <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>))</span>
<span id="cb54-9"><a href="titanic.html#cb54-9" aria-hidden="true"></a></span>
<span id="cb54-10"><a href="titanic.html#cb54-10" aria-hidden="true"></a></span>
<span id="cb54-11"><a href="titanic.html#cb54-11" aria-hidden="true"></a><span class="co">##</span></span></code></pre></div>
<pre><code>## personal 78.73</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
